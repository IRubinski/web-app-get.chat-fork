[{"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\index.js":"1","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\reportWebVitals.js":"2","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\App.js":"3","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Login.js":"4","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\AppTheme.js":"5","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Constants.js":"6","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\AvatarStyles.js":"7","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\ChatMessageClass.js":"8","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\AttachmentTypesMenu.js":"9","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\TemplateMessageClass.js":"10","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\SearchMessage.js":"11","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\SearchBar.js":"12","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\CreateTemplate.js":"13","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\SearchMessageResult.js":"14","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\SidebarContactResult.js":"15","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\ChatClass.js":"16","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\MessageDateIndicator.js":"17","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\FileInput.js":"18","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\ChosenFileClass.js":"19","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\hooks\\useForceUpdate.js":"20","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\VoiceRecorder.js":"21","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\VoiceRecord.js":"22","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\recorder\\worker.js":"23","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\ContextChatMessage.js":"24","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\NewMessageClass.js":"25","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Contacts.js":"26","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Contact.js":"27","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\PersonClass.js":"28","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\ContactClass.js":"29","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\ContactProviderHeader.js":"30","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Person.js":"31","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\ChatAssignmentEvent.js":"32","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\ChatTaggingEvent.js":"33","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\DownloadUnsupportedFile.js":"34","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\UnsupportedFileClass.js":"35","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\SavedResponseClass.js":"36","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\Chat.js":"37","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\Sidebar.js":"38","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageTypeIcon.js":"39","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatHeader.js":"40","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessage.js":"41","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatFooter.js":"42","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\SidebarChat.js":"43","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageOptionsMenu.js":"44","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\BusinessProfile.js":"45","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\ChangePasswordDialog.js":"46","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageVideo.js":"47","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageDocument.js":"48","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageImage.js":"49","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageVoice.js":"50","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageTemplate.js":"51","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageShortContent.js":"52","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageTypeLabel.js":"53","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\Helpers.js":"54","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\StorageHelper.js":"55","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\SidebarHelper.js":"56","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\FileHelper.js":"57","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\DateHelper.js":"58","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\ChatHelper.js":"59","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\BulkSendIndicator.js":"60","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\UserClass.js":"61","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\SelectableChatTag.js":"62","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\BulkSendActions.js":"63","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\Main.js":"64","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\ContactDetails.js":"65","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\ChatAssignment.js":"66","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\LoadingScreen.js":"67","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\ChatTags.js":"68","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\PreviewMedia.js":"69","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\ChatTagsList.js":"70","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\TemplateMessages.js":"71","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\SavedResponses.js":"72","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\PreviewSendMedia.js":"73","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\SendTemplateMessage.js":"74"},{"size":493,"mtime":1611658611905,"results":"75","hashOfConfig":"76"},{"size":362,"mtime":499162500000,"results":"77","hashOfConfig":"76"},{"size":799,"mtime":1623918900167,"results":"78","hashOfConfig":"76"},{"size":6145,"mtime":1623658694795,"results":"79","hashOfConfig":"76"},{"size":470,"mtime":1614783203762,"results":"80","hashOfConfig":"76"},{"size":2215,"mtime":1621948839326,"results":"81","hashOfConfig":"76"},{"size":3190,"mtime":1615884022638,"results":"82","hashOfConfig":"76"},{"size":7997,"mtime":1623658694784,"results":"83","hashOfConfig":"76"},{"size":1144,"mtime":1613394017720,"results":"84","hashOfConfig":"76"},{"size":385,"mtime":1621949173114,"results":"85","hashOfConfig":"76"},{"size":3592,"mtime":1623658694607,"results":"86","hashOfConfig":"76"},{"size":832,"mtime":1617352969214,"results":"87","hashOfConfig":"76"},{"size":2139,"mtime":1612957974714,"results":"88","hashOfConfig":"76"},{"size":2014,"mtime":1623658694445,"results":"89","hashOfConfig":"76"},{"size":902,"mtime":1613038108492,"results":"90","hashOfConfig":"76"},{"size":3024,"mtime":1623658694695,"results":"91","hashOfConfig":"76"},{"size":662,"mtime":1614241660266,"results":"92","hashOfConfig":"76"},{"size":547,"mtime":1614936205165,"results":"93","hashOfConfig":"76"},{"size":939,"mtime":1623658694524,"results":"94","hashOfConfig":"76"},{"size":203,"mtime":1614162338987,"results":"95","hashOfConfig":"76"},{"size":2494,"mtime":1614684068270,"results":"96","hashOfConfig":"76"},{"size":5838,"mtime":1623658694805,"results":"97","hashOfConfig":"76"},{"size":118,"mtime":1614680945459,"results":"98","hashOfConfig":"76"},{"size":1454,"mtime":1623417312157,"results":"99","hashOfConfig":"76"},{"size":178,"mtime":1616405971376,"results":"100","hashOfConfig":"76"},{"size":9813,"mtime":1623658694563,"results":"101","hashOfConfig":"76"},{"size":3037,"mtime":1618566407233,"results":"102","hashOfConfig":"76"},{"size":1090,"mtime":1623658694424,"results":"103","hashOfConfig":"76"},{"size":353,"mtime":1620644199040,"results":"104","hashOfConfig":"76"},{"size":714,"mtime":1618400027911,"results":"105","hashOfConfig":"76"},{"size":1520,"mtime":1617708662818,"results":"106","hashOfConfig":"76"},{"size":1788,"mtime":1621585829369,"results":"107","hashOfConfig":"76"},{"size":1161,"mtime":1621586387437,"results":"108","hashOfConfig":"76"},{"size":1037,"mtime":1621949418528,"results":"109","hashOfConfig":"76"},{"size":169,"mtime":1621949069241,"results":"110","hashOfConfig":"76"},{"size":203,"mtime":1623227699372,"results":"111","hashOfConfig":"76"},{"size":49519,"mtime":1623918900249,"results":"112","hashOfConfig":"76"},{"size":24525,"mtime":1623853850179,"results":"113","hashOfConfig":"76"},{"size":1370,"mtime":1623417312063,"results":"114","hashOfConfig":"76"},{"size":4112,"mtime":1623853032501,"results":"115","hashOfConfig":"76"},{"size":6946,"mtime":1623658694545,"results":"116","hashOfConfig":"76"},{"size":14148,"mtime":1623835992255,"results":"117","hashOfConfig":"76"},{"size":10219,"mtime":1623849223909,"results":"118","hashOfConfig":"76"},{"size":1148,"mtime":1623406023493,"results":"119","hashOfConfig":"76"},{"size":11785,"mtime":1623658694823,"results":"120","hashOfConfig":"76"},{"size":4481,"mtime":1623658694482,"results":"121","hashOfConfig":"76"},{"size":549,"mtime":1615383360076,"results":"122","hashOfConfig":"76"},{"size":539,"mtime":1615454217344,"results":"123","hashOfConfig":"76"},{"size":253,"mtime":1615385937537,"results":"124","hashOfConfig":"76"},{"size":5296,"mtime":1623658694505,"results":"125","hashOfConfig":"76"},{"size":3340,"mtime":1623658694573,"results":"126","hashOfConfig":"76"},{"size":1238,"mtime":1623658694649,"results":"127","hashOfConfig":"76"},{"size":1034,"mtime":1623417312133,"results":"128","hashOfConfig":"76"},{"size":9518,"mtime":1623658694752,"results":"129","hashOfConfig":"76"},{"size":1764,"mtime":1623755701643,"results":"130","hashOfConfig":"76"},{"size":1333,"mtime":1623658694577,"results":"131","hashOfConfig":"76"},{"size":6381,"mtime":1623658694456,"results":"132","hashOfConfig":"76"},{"size":256,"mtime":1612860915449,"results":"133","hashOfConfig":"76"},{"size":422,"mtime":1623667265404,"results":"134","hashOfConfig":"76"},{"size":472,"mtime":1623677639963,"results":"135","hashOfConfig":"76"},{"size":1133,"mtime":1623921355994,"results":"136","hashOfConfig":"76"},{"size":1402,"mtime":1623853432218,"results":"137","hashOfConfig":"76"},{"size":753,"mtime":1623853946513,"results":"138","hashOfConfig":"76"},{"size":31969,"mtime":1623918900294,"results":"139","hashOfConfig":"76"},{"size":7858,"mtime":1623918900264,"results":"140","hashOfConfig":"76"},{"size":5463,"mtime":1623921451993,"results":"141","hashOfConfig":"76"},{"size":1409,"mtime":1623918900186,"results":"142","hashOfConfig":"76"},{"size":6752,"mtime":1623918900158,"results":"143","hashOfConfig":"76"},{"size":1980,"mtime":1623918900132,"results":"144","hashOfConfig":"76"},{"size":2476,"mtime":1623918900273,"results":"145","hashOfConfig":"76"},{"size":6629,"mtime":1623918900254,"results":"146","hashOfConfig":"76"},{"size":1607,"mtime":1623918900195,"results":"147","hashOfConfig":"76"},{"size":11747,"mtime":1623918900149,"results":"148","hashOfConfig":"76"},{"size":8679,"mtime":1623918900219,"results":"149","hashOfConfig":"76"},{"filePath":"150","messages":"151","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},"qxyosp",{"filePath":"153","messages":"154","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"155","messages":"156","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"157","messages":"158","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"159","usedDeprecatedRules":"152"},{"filePath":"160","messages":"161","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"162","messages":"163","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"164","messages":"165","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"166","usedDeprecatedRules":"152"},{"filePath":"167","messages":"168","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"169","messages":"170","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"171","messages":"172","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"173","messages":"174","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"175","usedDeprecatedRules":"152"},{"filePath":"176","messages":"177","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"178","messages":"179","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"180","messages":"181","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"182","messages":"183","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"184","messages":"185","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"186","messages":"187","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"188","messages":"189","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"190","usedDeprecatedRules":"152"},{"filePath":"191","messages":"192","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"193","messages":"194","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"195","messages":"196","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"197","messages":"198","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"199","usedDeprecatedRules":"152"},{"filePath":"200","messages":"201","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"202","messages":"203","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"204","messages":"205","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"206","messages":"207","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"208","usedDeprecatedRules":"152"},{"filePath":"209","messages":"210","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"211","messages":"212","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"213","messages":"214","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"215","messages":"216","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"217","usedDeprecatedRules":"152"},{"filePath":"218","messages":"219","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"220","messages":"221","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"222","messages":"223","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"224","messages":"225","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"226","messages":"227","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"228","messages":"229","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"230","messages":"231","errorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"232","usedDeprecatedRules":"152"},{"filePath":"233","messages":"234","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"235","usedDeprecatedRules":"152"},{"filePath":"236","messages":"237","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"238","messages":"239","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"240","messages":"241","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"242","messages":"243","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"244","messages":"245","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"246","usedDeprecatedRules":"152"},{"filePath":"247","messages":"248","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"249","messages":"250","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"251","usedDeprecatedRules":"152"},{"filePath":"252","messages":"253","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"254","messages":"255","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"256","messages":"257","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"258","usedDeprecatedRules":"152"},{"filePath":"259","messages":"260","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"261","messages":"262","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"263","usedDeprecatedRules":"152"},{"filePath":"264","messages":"265","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"266","messages":"267","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"268","messages":"269","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"270","messages":"271","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"272","usedDeprecatedRules":"152"},{"filePath":"273","messages":"274","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"275","messages":"276","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"277","messages":"278","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"279","messages":"280","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"281","messages":"282","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"283","messages":"284","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"285","messages":"286","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"287","messages":"288","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"289","usedDeprecatedRules":"152"},{"filePath":"290","messages":"291","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"152"},{"filePath":"292","messages":"293","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"294","messages":"295","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"296","messages":"297","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"298","usedDeprecatedRules":"152"},{"filePath":"299","messages":"300","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"301","messages":"302","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"303","messages":"304","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"305","messages":"306","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"307","messages":"308","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"309","messages":"310","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"311","messages":"312","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"313","messages":"314","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\index.js",[],["315","316"],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\reportWebVitals.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\App.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Login.js",["317"],"import React, {useEffect, useState} from 'react';\r\nimport '../styles/Login.css';\r\nimport {Backdrop, CircularProgress, Fade, TextField} from '@material-ui/core';\r\nimport Button from '@material-ui/core/Button';\r\nimport {useHistory, useLocation, useParams} from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport {makeStyles} from '@material-ui/core/styles';\r\nimport {getConfig} from \"../Helpers/Helpers\";\r\nimport {Alert} from \"@material-ui/lab\";\r\nimport {BASE_URL, VERSION} from \"../Constants\";\r\nimport {clearToken, getToken, storeToken} from \"../Helpers/StorageHelper\";\r\nimport logo from '../assets/images/logo.png';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    backdrop: {\r\n        zIndex: theme.zIndex.drawer + 1,\r\n        color: '#fff',\r\n    },\r\n}));\r\n\r\nexport default function Login(props) {\r\n\r\n    const {errorCase} = useParams();\r\n\r\n    const errorMessages = {\r\n        \"incorrectRole\": \"Only admins and users can access to our web app.\",\r\n        \"notLoggedIn\": \"You are not logged in.\",\r\n        \"invalidToken\": \"Invalid token.\"\r\n    };\r\n\r\n    const classes = useStyles();\r\n\r\n    const [username, setUsername] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [isLoggingIn, setLoggingIn] = useState(false);\r\n    const [isValidatingToken, setValidatingToken] = useState(false);\r\n    const [loginError, setLoginError] = useState();\r\n\r\n    const history = useHistory();\r\n    const location = useLocation();\r\n\r\n    useEffect(() => {\r\n        if (errorCase) {\r\n            setLoginError(errorMessages[errorCase]);\r\n\r\n            if (errorCase === \"invalidToken\") {\r\n                logoutToClearSession();\r\n            }\r\n        }\r\n\r\n        const token = getToken();\r\n        if (token) {\r\n            setValidatingToken(true);\r\n            axios.get(BASE_URL, getConfig())\r\n                .then((response) => {\r\n                    // Redirect to main route\r\n                    history.push(\"/main\");\r\n                })\r\n                .catch((error) => {\r\n                    setValidatingToken(false);\r\n\r\n                    // TODO: Make sure the response is Unauthorized\r\n                    clearToken();\r\n                });\r\n        }\r\n    }, []);\r\n\r\n    const doLogin = async e => {\r\n        e.preventDefault();\r\n\r\n        // Check if username or password is empty\r\n        if (username.trim() === '' || password.trim() === '') {\r\n            // TODO: Display error on UI\r\n            console.log(\"Empty credentials\");\r\n            return false;\r\n        }\r\n\r\n        // Display the loading animation\r\n        setLoggingIn(true);\r\n\r\n        axios.post(`${BASE_URL}auth/token/`, {\r\n            username : username,\r\n            password : password\r\n        }).then((response) => {\r\n            // Store token in local storage\r\n            storeToken(response.data.token);\r\n\r\n            // Android web interface\r\n            if (window.AndroidWebInterface) {\r\n                window.AndroidWebInterface.registerUserToken(response.data.token ?? \"\");\r\n            }\r\n\r\n            // Redirect to main route\r\n            history.push((location.nextPath ?? \"/main\") + (location.search ?? \"\"));\r\n        }).catch((error) => {\r\n\r\n            // Hide the loading animation\r\n            setLoggingIn(false);\r\n            setLoginError(undefined);\r\n\r\n            // Handle the error\r\n            if (error.response) {\r\n                // Request made and server responded\r\n                console.log(error.response.data);\r\n                console.log(error.response.status);\r\n                console.log(error.response.headers);\r\n\r\n                setLoginError(\"Incorrect username or password.\");\r\n            } else if (error.request) {\r\n                // The request was made but no response was received\r\n                console.log(error.request);\r\n\r\n                setLoginError(\"An error has occurred.\");\r\n            } else {\r\n                // Something happened in setting up the request that triggered an Error\r\n                console.log('Error', error.message);\r\n\r\n                setLoginError(\"An error has occurred.\");\r\n            }\r\n        })\r\n    }\r\n\r\n    const logoutToClearSession = () => {\r\n        axios.get( `${BASE_URL}auth/logout/`, getConfig())\r\n            .then((response) => {\r\n                console.log(\"Logout: \", response.data);\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.error(error);\r\n            });\r\n    }\r\n\r\n    return (\r\n        <div className=\"login\">\r\n\r\n            <Fade in={true}>\r\n                <div className=\"login__body\">\r\n                    <div className=\"login__body__logoWrapper\">\r\n                        <img className=\"login__body__logo\" src={logo} alt=\"Logo\" />\r\n                    </div>\r\n\r\n                    <h2>Welcome</h2>\r\n                    <p>Please login to start</p>\r\n\r\n                    <form onSubmit={doLogin}>\r\n                        <TextField value={username} onChange={e => setUsername(e.target.value)} label=\"Username\" size=\"medium\" fullWidth={true} />\r\n                        <TextField value={password} onChange={e => setPassword(e.target.value)} type=\"password\" label=\"Password\" size=\"medium\" fullWidth={true} />\r\n                        <Button type=\"submit\" color=\"primary\" fullWidth={true} disableElevation>Login</Button>\r\n                    </form>\r\n\r\n                    {isValidatingToken &&\r\n                    <div className=\"login__validatingToken\">\r\n                        <h2>Welcome</h2>\r\n                        <p>We are validating your session, please wait.</p>\r\n                    </div>\r\n                    }\r\n\r\n                    {loginError &&\r\n                    <Alert severity=\"error\">{loginError}</Alert>\r\n                    }\r\n\r\n                    <div className=\"login__body__versionWrapper\">\r\n                        <span className=\"login__body__version\">Version: { VERSION }</span>\r\n                    </div>\r\n                </div>\r\n            </Fade>\r\n\r\n            <Backdrop className={classes.backdrop} open={isLoggingIn}>\r\n                <CircularProgress color=\"inherit\" />\r\n            </Backdrop>\r\n\r\n        </div>\r\n    )\r\n}","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\AppTheme.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Constants.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\AvatarStyles.js",["318"],"import {makeStyles} from \"@material-ui/core/styles\";\r\n\r\nfunction hashCode(str) {\r\n    let hash = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n        hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n    }\r\n    return hash;\r\n}\r\n\r\nfunction intToRGB(i) {\r\n    const c = (i & 0x00FFFFFF)\r\n        .toString(16)\r\n        .toUpperCase();\r\n\r\n    return \"00000\".substring(0, 6 - c.length) + c;\r\n}\r\n\r\nconst prepareStylesObject = () => {\r\n    let obj = {};\r\n    for (let i = 65; i <= 90; i++) {\r\n        const curLetter = String.fromCharCode(i);\r\n        obj[curLetter] = {\r\n            color: '#fff',\r\n            backgroundColor: '#' + intToRGB(hashCode(curLetter.repeat(6)))\r\n        };\r\n    }\r\n    obj[\"orange\"] = {\"color\": \"#fff\", \"backgroundColor\": \"#ff9a10\"};\r\n\r\n    return obj;\r\n}\r\n\r\n// In case generating colors is needed again, this can be enabled\r\n//const avatarStyles = makeStyles((theme) => (prepareStylesObject()));\r\n\r\nconst avatarStyles = makeStyles((theme) => ({\r\n    \"A\": {\"color\": \"#fff\", \"backgroundColor\": \"#9D8060\"},\r\n    \"B\": {\"color\": \"#fff\", \"backgroundColor\": \"#60E8C0\"},\r\n    \"C\": {\"color\": \"#fff\", \"backgroundColor\": \"#245120\"},\r\n    \"D\": {\"color\": \"#fff\", \"backgroundColor\": \"#E7B980\"},\r\n    \"E\": {\"color\": \"#fff\", \"backgroundColor\": \"#AB21E0\"},\r\n    \"F\": {\"color\": \"#fff\", \"backgroundColor\": \"#6E8A40\"},\r\n    \"G\": {\"color\": \"#fff\", \"backgroundColor\": \"#31d5f2\"},\r\n    \"H\": {\"color\": \"#fff\", \"backgroundColor\": \"#f55600\"},\r\n    \"I\": {\"color\": \"#fff\", \"backgroundColor\": \"#B8C360\"},\r\n    \"J\": {\"color\": \"#fff\", \"backgroundColor\": \"#7C2BC0\"},\r\n    \"K\": {\"color\": \"#fff\", \"backgroundColor\": \"#bc942e\"},\r\n    \"L\": {\"color\": \"#fff\", \"backgroundColor\": \"#02FC80\"},\r\n    \"M\": {\"color\": \"#fff\", \"backgroundColor\": \"#C664E0\"},\r\n    \"N\": {\"color\": \"#fff\", \"backgroundColor\": \"#89CD40\"},\r\n    \"O\": {\"color\": \"#fff\", \"backgroundColor\": \"#4e2a88\"},\r\n    \"P\": {\"color\": \"#fff\", \"backgroundColor\": \"#109E00\"},\r\n    \"Q\": {\"color\": \"#fff\", \"backgroundColor\": \"#ee2a81\"},\r\n    \"R\": {\"color\": \"#fff\", \"backgroundColor\": \"#976EC0\"},\r\n    \"S\": {\"color\": \"#fff\", \"backgroundColor\": \"#5AD720\"},\r\n    \"T\": {\"color\": \"#fff\", \"backgroundColor\": \"#1E3F80\"},\r\n    \"U\": {\"color\": \"#fff\", \"backgroundColor\": \"#E1A7E0\"},\r\n    \"V\": {\"color\": \"#fff\", \"backgroundColor\": \"#A51040\"},\r\n    \"W\": {\"color\": \"#fff\", \"backgroundColor\": \"#6878A0\"},\r\n    \"X\": {\"color\": \"#fff\", \"backgroundColor\": \"#2BE100\"},\r\n    \"Y\": {\"color\": \"#fff\", \"backgroundColor\": \"#EF4960\"},\r\n    \"Z\": {\"color\": \"#fff\", \"backgroundColor\": \"#B2B1C0\"},\r\n    \"orange\": {\"color\": \"#fff\", \"backgroundColor\": \"#ff9a10\"}\r\n}));\r\n\r\nexport {avatarStyles}","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\ChatMessageClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\AttachmentTypesMenu.js",["319","320"],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\TemplateMessageClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\SearchMessage.js",["321"],"import React, {useEffect, useState} from 'react';\r\nimport '../styles/SearchMessage.css';\r\nimport {IconButton} from \"@material-ui/core\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\nimport PubSub from \"pubsub-js\";\r\nimport {BASE_URL, EVENT_TOPIC_GO_TO_MSG_ID, EVENT_TOPIC_SEARCH_MESSAGES_VISIBILITY} from \"../Constants\";\r\nimport SearchBar from \"./SearchBar\";\r\nimport {useParams} from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport {getConfig} from \"../Helpers\";\r\nimport ChatMessageClass from \"../ChatMessageClass\";\r\nimport SearchMessageResult from \"./SearchMessageResult\";\r\n\r\nfunction SearchMessage(props) {\r\n\r\n    const [results, setResults] = useState({});\r\n    const [keyword, setKeyword] = useState(\"\");\r\n    const {waId} = useParams();\r\n\r\n    useEffect(() => {\r\n        setResults({});\r\n    }, [waId]);\r\n\r\n    const hideSearchMessages = () => {\r\n        PubSub.publish(EVENT_TOPIC_SEARCH_MESSAGES_VISIBILITY, false);\r\n    }\r\n\r\n    let cancelToken;\r\n\r\n    const search = async (_keyword) => {\r\n        setKeyword(_keyword);\r\n\r\n        // Check if there are any previous pending requests\r\n        if (cancelToken !== undefined) {\r\n            cancelToken.cancel(\"Operation canceled due to new request.\");\r\n        }\r\n\r\n        // Generate a token\r\n        cancelToken = axios.CancelToken.source();\r\n\r\n        if (_keyword.trim().length === 0) {\r\n            setResults({});\r\n            return false;\r\n        }\r\n\r\n        axios.get( `${BASE_URL}messages/${waId}/`,\r\n            getConfig({\r\n                //offset: offset ?? 0,\r\n                limit: 30,\r\n                search: _keyword\r\n            }, cancelToken.token)\r\n        )\r\n            .then((response) => {\r\n                console.log(\"Messages\", response.data);\r\n\r\n                const preparedMessages = {};\r\n                response.data.results.map((message, index) => {\r\n                    const prepared = new ChatMessageClass(message);\r\n                    preparedMessages[prepared.id] = prepared;\r\n                });\r\n\r\n                setResults(preparedMessages);\r\n\r\n            })\r\n            .catch((error) => {\r\n                // TODO: Handle errors\r\n\r\n                //displayError(error);\r\n            });\r\n    }\r\n\r\n    const goToMessage = (data) => {\r\n        PubSub.publish(EVENT_TOPIC_GO_TO_MSG_ID, data);\r\n    }\r\n\r\n    return (\r\n        <div className=\"searchMessage\">\r\n            <div className=\"searchMessage__header\">\r\n                <IconButton onClick={hideSearchMessages}>\r\n                    <CloseIcon />\r\n                </IconButton>\r\n\r\n                <h3>Search For Messages</h3>\r\n            </div>\r\n\r\n            <SearchBar onChange={search} />\r\n\r\n            <div className=\"searchMessage__body\">\r\n                { Object.entries(results).map((message, index) =>\r\n                    <SearchMessageResult\r\n                        key={message[0]}\r\n                        waId={waId}\r\n                        messageData={message[1]}\r\n                        keyword={keyword}\r\n                        onClick={(chatMessage) => goToMessage(chatMessage)}/>\r\n                )}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SearchMessage;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\SearchBar.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\CreateTemplate.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\SearchMessageResult.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\SidebarContactResult.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\ChatClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\MessageDateIndicator.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\FileInput.js",["322"],"import React, {useState} from \"react\";\r\n\r\nfunction FileInput(props) {\r\n\r\n    return (\r\n        <input\r\n            ref={props.innerRef}\r\n            type=\"file\"\r\n            onChange={(e) => props.handleSelectedFiles(e.target.files)}\r\n            multiple={true}\r\n            onClick={(event)=> {\r\n                event.target.value = null\r\n            }}\r\n            accept={props.accept}\r\n        />\r\n    )\r\n}\r\n\r\nexport default FileInput;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\ChosenFileClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\hooks\\useForceUpdate.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\VoiceRecorder.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\VoiceRecord.js",["323","324","325"],"import React, {useEffect, useRef, useState} from \"react\";\r\nimport {Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, IconButton} from \"@material-ui/core\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\nimport FiberManualRecordIcon from \"@material-ui/icons/FiberManualRecord\";\r\nimport {displaySeconds} from \"../Helpers\";\r\nimport DoneIcon from \"@material-ui/icons/Done\";\r\nimport '../styles/VoiceRecord.css';\r\nimport VoiceRecorder from \"../VoiceRecorder\";\r\nimport {EVENT_TOPIC_DISPLAY_ERROR, EVENT_TOPIC_REQUEST_MIC_PERMISSION} from \"../Constants\";\r\nimport PubSub from \"pubsub-js\";\r\nimport {useParams} from \"react-router-dom\";\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\nlet timerIntervalId;\r\n\r\nfunction VoiceRecord(props) {\r\n\r\n    const voiceRecorder = useRef(new VoiceRecorder());\r\n    const [timer, setTimer] = useState(0);\r\n\r\n    const {waId} = useParams();\r\n\r\n    const [open, setOpen] = React.useState(false);\r\n\r\n    const handleClickOpen = () => {\r\n        setOpen(true);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    useEffect(() => {\r\n        const onRequestMicPermission = function (msg, data) {\r\n            requestMicrophonePermission();\r\n        }\r\n\r\n        const token = PubSub.subscribe(EVENT_TOPIC_REQUEST_MIC_PERMISSION, onRequestMicPermission);\r\n\r\n        return () => {\r\n            PubSub.unsubscribe(token);\r\n\r\n            cancelVoiceRecord();\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        cancelVoiceRecord();\r\n    }, [waId]);\r\n\r\n    const cancelVoiceRecord = () => {\r\n        voiceRecorder.current?.cancel();\r\n\r\n        onVoiceRecordStop();\r\n    }\r\n\r\n    const onVoiceRecordStop = () => {\r\n        props.setRecording(false);\r\n\r\n        // Stop timer\r\n        clearInterval(timerIntervalId);\r\n        setTimer(0);\r\n    }\r\n\r\n    const requestMicrophonePermission = () => {\r\n        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n\r\n            const constraints = {\r\n                audio: {\r\n                    sampleRate: 48000,\r\n                    channelCount: 1,\r\n                    volume: 1.0,\r\n                    noiseSuppression: true\r\n                },\r\n                video: false\r\n            };\r\n\r\n            navigator.mediaDevices.getUserMedia(constraints)\r\n                .then(function (stream) {\r\n                    startVoiceRecord(stream);\r\n                })\r\n                .catch(function (err) {\r\n                    console.log('Permission denied');\r\n\r\n                    PubSub.publish(EVENT_TOPIC_DISPLAY_ERROR, 'You must grant microphone permission.');\r\n\r\n                    if (window.AndroidWebInterface) {\r\n                        window.AndroidWebInterface.requestPermissions();\r\n                    }\r\n\r\n                    // Check if iframe\r\n                    if (window.self !== window.top) {\r\n                        setOpen(true);\r\n                    }\r\n                });\r\n        } else {\r\n            console.log('Not supported on your browser.');\r\n\r\n            PubSub.publish(EVENT_TOPIC_DISPLAY_ERROR, 'This feature is not supported on your browser.');\r\n        }\r\n    }\r\n\r\n    const startVoiceRecord = (stream) => {\r\n        // If it is already recording, return\r\n        if (voiceRecorder.current?.isRecording()) return;\r\n\r\n        // Start recording\r\n        voiceRecorder.current?.start(\r\n            stream,\r\n            function () {\r\n                props.setRecording(true);\r\n\r\n                // Update timer every second\r\n                timerIntervalId = setInterval(function () {\r\n                    setTimer(prevState => prevState + 1);\r\n                }, 1000);\r\n            },\r\n            function () {\r\n                onVoiceRecordStop();\r\n            },\r\n            function (audioFile) {\r\n                //console.log(audioFile);\r\n            }\r\n        );\r\n    }\r\n\r\n    const stopVoiceRecord = () => {\r\n        voiceRecorder.current?.stop();\r\n    }\r\n\r\n    const sendVoiceRecord = () => {\r\n        stopVoiceRecord();\r\n\r\n        setTimeout(function () {\r\n            const chosenFile = voiceRecorder.current.lastAudioChosenFile;\r\n\r\n            // Send\r\n            if (chosenFile) {\r\n                props.sendHandledChosenFiles({0: voiceRecorder.current.lastAudioChosenFile});\r\n            } else {\r\n                console.log('Audio file is missing');\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    const goToInbox = () => {\r\n        window.open(window.location.href, '_blank');\r\n        handleClose();\r\n    }\r\n\r\n    return (\r\n        <div className=\"voiceRecord\">\r\n            <IconButton onClick={stopVoiceRecord} className=\"voiceRecord__cancelButton\">\r\n                <CloseIcon />\r\n            </IconButton>\r\n\r\n            <FiberManualRecordIcon className=\"voiceRecord__recordIcon\" />\r\n            <span className=\"voiceRecord__timer\">{ displaySeconds(timer) }</span>\r\n\r\n            <IconButton onClick={sendVoiceRecord} className=\"voiceRecord__sendButton\">\r\n                <DoneIcon />\r\n            </IconButton>\r\n\r\n            <Dialog\r\n                open={open}\r\n                onClose={handleClose}>\r\n                <DialogTitle>Oops!</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You must open the inbox in a new tab to access this feature.\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={handleClose} color=\"secondary\">\r\n                        Close\r\n                    </Button>\r\n                    <Button onClick={goToInbox} color=\"primary\" autoFocus>\r\n                        Go to inbox\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default VoiceRecord;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\recorder\\worker.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\ContextChatMessage.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\NewMessageClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Contacts.js",["326","327","328"],"import React, {useEffect, useRef, useState} from \"react\";\r\nimport '../styles/Contacts.css';\r\nimport axios from \"axios\";\r\nimport {BASE_URL} from \"../Constants\";\r\nimport {addPlusToPhoneNumber, getConfig, getObjLength, preparePhoneNumber, removeWhitespaces} from \"../Helpers\";\r\nimport SearchBar from \"./SearchBar\";\r\nimport {Button, CircularProgress, IconButton, InputAdornment, ListItem, TextField} from \"@material-ui/core\";\r\nimport {ArrowBack} from \"@material-ui/icons\";\r\nimport DialpadIcon from '@material-ui/icons/Dialpad';\r\nimport Contact from \"./Contact\";\r\nimport ContactClass from \"../ContactClass\";\r\nimport {isMobileOnly} from \"react-device-detect\";\r\nimport {useHistory} from \"react-router-dom\";\r\nimport PersonClass from \"../PersonClass\";\r\n\r\nfunction Contacts(props) {\r\n\r\n    const [keyword, setKeyword] = useState(\"\");\r\n    const [contacts, setContacts] = useState({});\r\n    const [persons, setPersons] = useState({});\r\n    const [isLoading, setLoading] = useState(false);\r\n    const [isVerifying, setVerifying] = useState(false);\r\n    const [isPhoneNumberFormVisible, setPhoneNumberFormVisible] = useState(false);\r\n    const [phoneNumber, setPhoneNumber] = useState(\"\")\r\n\r\n    let cancelTokenSourceRef = useRef();\r\n    let verifyPhoneNumberCancelTokenSourceRef = useRef();\r\n\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        const handleKey = (event) => {\r\n            if (event.keyCode === 27) { // Escape\r\n                props.onHide();\r\n            }\r\n        }\r\n\r\n        document.addEventListener('keydown', handleKey);\r\n\r\n        // Generate a token\r\n        cancelTokenSourceRef.current = axios.CancelToken.source();\r\n\r\n        verifyPhoneNumberCancelTokenSourceRef.current = axios.CancelToken.source();\r\n\r\n        findContacts();\r\n\r\n        return () => {\r\n            document.removeEventListener('keydown', handleKey);\r\n            cancelTokenSourceRef.current.cancel();\r\n            verifyPhoneNumberCancelTokenSourceRef.current.cancel();\r\n        }\r\n    }, []);\r\n\r\n    let timeout = useRef();\r\n\r\n    useEffect(() => {\r\n        // Generate a token\r\n        cancelTokenSourceRef.current = axios.CancelToken.source();\r\n\r\n        if (keyword?.length > 0) {\r\n            setLoading(true);\r\n\r\n            timeout.current = setTimeout(function () {\r\n                findPersons();\r\n                findContacts();\r\n            }, 500);\r\n        }\r\n\r\n        return () => {\r\n            cancelTokenSourceRef.current.cancel();\r\n            clearTimeout(timeout.current);\r\n            setLoading(false);\r\n        }\r\n    }, [keyword]);\r\n\r\n    const findContacts = () => {\r\n        axios.get(`${BASE_URL}contacts/`, getConfig({\r\n            search: keyword?.trim()\r\n        }, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(\"Contacts list\", response.data);\r\n\r\n                const preparedContacts = {};\r\n                response.data.results.forEach((contact, contactIndex) => {\r\n                    preparedContacts[contactIndex] = new ContactClass(contact);\r\n                });\r\n\r\n                setContacts(preparedContacts);\r\n\r\n                setLoading(false);\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n                window.displayError(error);\r\n                setLoading(false);\r\n            });\r\n    }\r\n\r\n    const findPersons = () => {\r\n        axios.get(`${BASE_URL}persons/`, getConfig({\r\n            search: keyword?.trim()\r\n        }, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(\"Persons list\", response.data);\r\n\r\n                const preparedPersons = {};\r\n                response.data.results.forEach((person, personIndex) => {\r\n                    preparedPersons[personIndex] = new PersonClass(person);\r\n                });\r\n\r\n                setPersons(preparedPersons);\r\n\r\n                setLoading(false);\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n                window.displayError(error);\r\n                setLoading(false);\r\n            });\r\n    }\r\n\r\n    const verifyPhoneNumber = (data, waId) => {\r\n        setVerifying(true);\r\n\r\n        axios.post( `${BASE_URL}contacts/verify/`, {\r\n            blocking: \"wait\",\r\n            contacts: [addPlusToPhoneNumber(waId)],\r\n            force_check: true\r\n        }, getConfig(undefined, verifyPhoneNumberCancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(\"Verify\", response.data);\r\n\r\n                if (response.data.contacts && response.data.contacts.length > 0 && response.data.contacts[0].status === \"valid\") {\r\n                    history.push({\r\n                        pathname: `/main/chat/${waId}`,\r\n                        person: {\r\n                            name: data?.name,\r\n                            initials: data?.initials,\r\n                            avatar: data?.avatar,\r\n                            waId: waId\r\n                        }\r\n                    });\r\n\r\n                    // Hide contacts on mobile\r\n                    if (isMobileOnly) {\r\n                        props.onHide();\r\n                    }\r\n\r\n                } else {\r\n                    window.displayCustomError(\"There is no WhatsApp account connected to this phone number.\");\r\n                }\r\n\r\n                setVerifying(false);\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n                window.displayError(error);\r\n\r\n                setVerifying(false);\r\n            });\r\n    }\r\n\r\n    const startChatWithPhoneNumber = () => {\r\n        verifyPhoneNumber(undefined, preparePhoneNumber(phoneNumber));\r\n    }\r\n\r\n    return (\r\n        <div className=\"contacts\">\r\n            <div className=\"contacts__header\">\r\n                <IconButton onClick={props.onHide}>\r\n                    <ArrowBack />\r\n                </IconButton>\r\n\r\n                <h3>New chat</h3>\r\n            </div>\r\n\r\n            <div className=\"contacts__startByPhoneNumberWrapper\">\r\n                <div className=\"contacts__startByPhoneNumber\" onClick={() => setPhoneNumberFormVisible(prevState => !prevState)}>\r\n                    <ListItem button>\r\n                        <div className=\"contacts__startByPhoneNumber__inner\">\r\n                            <DialpadIcon />\r\n                            <span>Start a chat with a phone number</span>\r\n                        </div>\r\n                    </ListItem>\r\n                </div>\r\n\r\n                {isPhoneNumberFormVisible &&\r\n                <div className=\"contacts__startByPhoneNumberWrapper__formWrapper\">\r\n                    <TextField\r\n                        label=\"Phone number\"\r\n                        InputProps={{\r\n                            startAdornment: <InputAdornment position=\"start\">+</InputAdornment>,\r\n                        }}\r\n                        onChange={event => setPhoneNumber(event.target.value)} />\r\n                    <Button color=\"primary\" onClick={startChatWithPhoneNumber}>Start</Button>\r\n                </div>\r\n                }\r\n            </div>\r\n\r\n            <SearchBar\r\n                placeholder=\"Search for contacts\"\r\n                onChange={setKeyword}\r\n                isLoading={isLoading} />\r\n\r\n            <div className=\"contacts__body\">\r\n                {keyword?.length === 0 &&\r\n                <span className=\"contacts__body__hint\">Enter a keyword to start searching for contacts</span>\r\n                }\r\n\r\n                {getObjLength(persons) > 0 &&\r\n                <h3>Persons</h3>\r\n                }\r\n\r\n                { Object.entries(persons).map((person, index) =>\r\n                    <Contact\r\n                        key={index}\r\n                        data={person[1]}\r\n                        verifyPhoneNumber={verifyPhoneNumber}\r\n                        onHide={props.onHide} />\r\n                )}\r\n\r\n                {(keyword?.trim()?.length > 0 && getObjLength(contacts) > 0) &&\r\n                <h3>Contacts</h3>\r\n                }\r\n\r\n                { Object.entries(contacts).map((contact, index) =>\r\n                    <Contact\r\n                        key={index}\r\n                        data={contact[1]}\r\n                        verifyPhoneNumber={verifyPhoneNumber}\r\n                        onHide={props.onHide} />\r\n                )}\r\n\r\n                {isVerifying &&\r\n                <div className=\"contacts__body__loading\">\r\n                    <CircularProgress color=\"inherit\" />\r\n                </div>\r\n                }\r\n\r\n                {(keyword?.length > 0 && getObjLength(contacts) === 0 && !isLoading) &&\r\n                <span className=\"contacts__body__hint\">No contacts found for <span\r\n                    className=\"searchOccurrence\">{keyword}</span></span>\r\n                }\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Contacts;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Contact.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\PersonClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\ContactClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\ContactProviderHeader.js",["329","330","331"],"import React from \"react\";\r\nimport '../styles/ContactProviderHeader.css';\r\nimport googleLogo from '../assets/images/ic-google.png';\r\nimport whatsappLogo from '../assets/images/ic-whatsapp.png';\r\nimport hubspotLogo from '../assets/images/ic-hubspot.png';\r\n\r\nfunction ContactProviderHeader(props) {\r\n    return (\r\n        <div className=\"contactProviderHeader\">\r\n            {props.type === \"whatsapp\" &&\r\n            <img src={whatsappLogo} />\r\n            }\r\n            {props.type === \"google\" &&\r\n            <img src={googleLogo} />\r\n            }\r\n            {props.type === \"hubspot\" &&\r\n            <img src={hubspotLogo} />\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ContactProviderHeader;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Person.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\ChatAssignmentEvent.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\ChatTaggingEvent.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\DownloadUnsupportedFile.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\UnsupportedFileClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\SavedResponseClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\Chat.js",["332","333","334","335","336","337","338","339"],"import React, {useEffect, useRef, useState} from 'react'\r\nimport '../../styles/Chat.css'\r\nimport {CircularProgress, Zoom} from \"@material-ui/core\";\r\nimport ChatMessage from \"./ChatMessage/ChatMessage\";\r\nimport {useHistory, useLocation, useParams} from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport {\r\n    ATTACHMENT_TYPE_DOCUMENT,\r\n    ATTACHMENT_TYPE_IMAGE,\r\n    ATTACHMENT_TYPE_VIDEO,\r\n    BASE_URL,\r\n    EVENT_TOPIC_CHAT_ASSIGNMENT,\r\n    EVENT_TOPIC_CHAT_MESSAGE_STATUS_CHANGE,\r\n    EVENT_TOPIC_CHAT_TAGGING,\r\n    EVENT_TOPIC_DROPPED_FILES,\r\n    EVENT_TOPIC_EMOJI_PICKER_VISIBILITY,\r\n    EVENT_TOPIC_GO_TO_MSG_ID,\r\n    EVENT_TOPIC_MARKED_AS_RECEIVED,\r\n    EVENT_TOPIC_NEW_CHAT_MESSAGES,\r\n    EVENT_TOPIC_SEND_TEMPLATE_MESSAGE_ERROR,\r\n    EVENT_TOPIC_SENT_TEMPLATE_MESSAGE,\r\n    EVENT_TOPIC_UPDATE_PERSON_NAME\r\n} from \"../../Constants\";\r\nimport ChatMessageClass from \"../../ChatMessageClass\";\r\nimport PersonClass from \"../../PersonClass\";\r\nimport TemplateMessages from \"../TemplateMessages\";\r\nimport ChatFooter from \"./ChatFooter\";\r\nimport ChatHeader from \"./ChatHeader\";\r\nimport ChatMessageOptionsMenu from \"./ChatMessage/ChatMessageOptionsMenu\";\r\nimport moment from \"moment\";\r\nimport PubSub from \"pubsub-js\";\r\nimport MessageDateIndicator from \"../MessageDateIndicator\";\r\nimport {\r\n    extractTimestampFromMessage, generateUnixTimestamp,\r\n    getConfig,\r\n    getFirstObject,\r\n    getLastMessageAndExtractTimestamp,\r\n    getLastObject,\r\n    getObjLength,\r\n    hasInternetConnection, isScrollable,\r\n    sortMessagesAsc,\r\n    translateHTMLInputToText\r\n} from \"../../Helpers/Helpers\";\r\nimport PreviewSendMedia from \"../PreviewSendMedia\";\r\nimport {getDroppedFiles, handleDragOver, prepareSelectedFiles} from \"../../Helpers/FileHelper\";\r\nimport SavedResponses from \"../SavedResponses\";\r\nimport {generateTemplateMessagePayload} from \"../../Helpers/ChatHelper\";\r\nimport {isMobileOnly} from \"react-device-detect\";\r\n\r\nconst SCROLL_OFFSET = 15;\r\nconst SCROLL_LAST_MESSAGE_VISIBILITY_OFFSET = 150;\r\n\r\nexport default function Chat(props) {\r\n\r\n    const messagesContainer = useRef(null);\r\n\r\n    const [fixedDateIndicatorText, setFixedDateIndicatorText] = useState();\r\n    const [isLoaded, setLoaded] = useState(false);\r\n    const [isLoadingMoreMessages, setLoadingMoreMessages] = useState(false);\r\n    const [isExpired, setExpired] = useState(false);\r\n    const [isTemplateMessagesVisible, setTemplateMessagesVisible] = useState(false);\r\n    const [isSavedResponsesVisible, setSavedResponsesVisible] = useState(false);\r\n    const [person, setPerson] = useState();\r\n    const [messages, setMessages] = useState({});\r\n    const [input, setInput] = useState('');\r\n    const [isScrollButtonVisible, setScrollButtonVisible] = useState(false);\r\n\r\n    const [selectedFiles, setSelectedFiles] = useState();\r\n    const [accept, setAccept] = useState('');\r\n\r\n    const [isPreviewSendMediaVisible, setPreviewSendMediaVisible] = useState(false);\r\n    const [previewSendMediaData, setPreviewSendMediaData] = useState();\r\n\r\n    const [currentNewMessages, setCurrentNewMessages] = useState(0);\r\n\r\n    const [isAtBottom, setAtBottom] = useState(false);\r\n\r\n    const [lastMessageId, setLastMessageId] = useState();\r\n\r\n    const {waId} = useParams();\r\n\r\n    const history = useHistory();\r\n    const location = useLocation();\r\n\r\n    const cancelTokenSourceRef = useRef();\r\n\r\n    useEffect(() => {\r\n        props.retrieveContactData(waId);\r\n\r\n        // Generate a token\r\n        cancelTokenSourceRef.current = axios.CancelToken.source();\r\n\r\n        if (messagesContainer) {\r\n            messagesContainer.current.addEventListener('DOMNodeInserted', event => {\r\n                if (event.target.parentNode.id === \"chat__body\") {\r\n                    const {currentTarget: target} = event;\r\n                    target.scroll({top: target.scrollHeight - target.offsetHeight - SCROLL_OFFSET});\r\n                }\r\n            });\r\n        }\r\n\r\n        // Handle files dragged and dropped to sidebar chat\r\n        const handleFilesDropped = function (msg, data) {\r\n            setSelectedFiles(data);\r\n        }\r\n\r\n        // Listen for file drop events\r\n        const token = PubSub.subscribe(EVENT_TOPIC_DROPPED_FILES, handleFilesDropped);\r\n\r\n        return () => {\r\n            // Cancelling ongoing requests\r\n            cancelTokenSourceRef.current.cancel();\r\n\r\n            // Unsubscribe\r\n            PubSub.unsubscribe(token);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        setLoaded(false);\r\n\r\n        // Clear values for next route\r\n        setPerson(null);\r\n        setMessages([]);\r\n        setTemplateMessagesVisible(false);\r\n        setSavedResponsesVisible(false);\r\n        setAtBottom(false);\r\n        setInput('');\r\n\r\n        setPreviewSendMediaVisible(false);\r\n        setPreviewSendMediaData(undefined);\r\n\r\n        props.previewMedia(null);\r\n\r\n        // Close emoji picker\r\n        PubSub.publish(EVENT_TOPIC_EMOJI_PICKER_VISIBILITY, false);\r\n\r\n        if (!waId) {\r\n            console.log('waId is empty.');\r\n            return false;\r\n        }\r\n\r\n        // Load contact and messages\r\n        getPerson(true);\r\n\r\n        return () => {\r\n            // Cancelling ongoing requests\r\n            cancelTokenSourceRef.current.cancel();\r\n\r\n            // Generate a new token, because component is not destroyed\r\n            cancelTokenSourceRef.current = axios.CancelToken.source();\r\n        }\r\n    }, [waId]);\r\n\r\n    useEffect(() => {\r\n        props.setChosenContact(person);\r\n    }, [person]);\r\n\r\n    const getNewMessagesCount = () => {\r\n        return props.newMessages[waId]?.newMessages ?? 0;\r\n    }\r\n\r\n    useEffect(() => {\r\n        const newMessagesCount = getNewMessagesCount();\r\n        if (newMessagesCount > currentNewMessages) {\r\n            setCurrentNewMessages(newMessagesCount);\r\n        }\r\n    }, [waId, props.newMessages]);\r\n\r\n    useEffect(() => {\r\n        const messagesContainerCopy = messagesContainer.current;\r\n        const dateIndicators = messagesContainerCopy.querySelectorAll('.chat__message__outer > .chat__message__dateContainer > .chat__message__dateContainer__indicator');\r\n\r\n        // To optimize scroll event\r\n        let debounceTimer;\r\n\r\n        // Consider replacing this with IntersectionObserver\r\n        // Browser support should be considered: https://caniuse.com/intersectionobserver\r\n        function handleScroll(e) {\r\n            if (debounceTimer) {\r\n                window.clearTimeout(debounceTimer);\r\n            }\r\n\r\n            debounceTimer = setTimeout(function () {\r\n                const threshold = 0;\r\n                const el = e.target;\r\n\r\n                if (isScrollable(el)) {\r\n                    if (!canSeeLastMessage(el)) {\r\n                        setScrollButtonVisible(true);\r\n                    } else if (isAtBottom) {\r\n                        setScrollButtonVisible(false);\r\n\r\n                        if (currentNewMessages > 0) {\r\n                            const lastMessage = getLastObject(messages);\r\n                            if (lastMessage) {\r\n                                markAsReceived(extractTimestampFromMessage(lastMessage));\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (el.scrollTop <= threshold) {\r\n                        //console.log(\"Scrolled to top\");\r\n                        if (isLoaded && !isLoadingMoreMessages) {\r\n                            setLoadingMoreMessages(true);\r\n                            getMessages(false, undefined, getFirstObject(messages)?.timestamp);\r\n                        }\r\n                    } else {\r\n                        // TODO: Make sure user scrolls\r\n                        if (el.scrollHeight - el.scrollTop - el.clientHeight < 1) {\r\n                            //console.log('Scrolled to bottom');\r\n                            if (isLoaded && !isLoadingMoreMessages && !isAtBottom) {\r\n                                setLoadingMoreMessages(true);\r\n                                getMessages(false, undefined, undefined, undefined, getLastObject(messages)?.timestamp, true, false);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Second part, to display date\r\n                if (isLoaded) {\r\n                    prepareFixedDateIndicator(dateIndicators, el);\r\n                }\r\n            }, 100);\r\n        }\r\n\r\n        if (messagesContainer && isLoaded) {\r\n            messagesContainerCopy.addEventListener(\"scroll\", handleScroll);\r\n\r\n            // Display fixed date indicator\r\n            prepareFixedDateIndicator(dateIndicators, messagesContainerCopy);\r\n        }\r\n\r\n        return () => {\r\n            clearTimeout(debounceTimer);\r\n            messagesContainerCopy.removeEventListener(\"scroll\", handleScroll);\r\n        }\r\n    }, [messages, isLoaded, isLoadingMoreMessages, isAtBottom, currentNewMessages]);\r\n\r\n    useEffect(() => {\r\n        // New messages\r\n        const onNewMessages = function (msg, data) {\r\n            if (data && isLoaded) {\r\n                let hasAnyIncomingMsg = false;\r\n\r\n                const preparedMessages = {};\r\n                Object.entries(data).forEach((message) => {\r\n                    const msgId = message[0];\r\n                    const chatMessage = message[1];\r\n\r\n                    if (waId === chatMessage.waId) {\r\n                        preparedMessages[msgId] = chatMessage;\r\n\r\n                        if (!chatMessage.isFromUs) {\r\n                            hasAnyIncomingMsg = true;\r\n                        }\r\n                    }\r\n                });\r\n\r\n                if (getObjLength(preparedMessages) > 0) {\r\n                    const lastMessage = getLastObject(preparedMessages);\r\n\r\n                    if (isAtBottom) {\r\n                        const prevScrollTop = messagesContainer.current.scrollTop;\r\n                        const prevScrollHeight = messagesContainer.current.scrollHeight;\r\n                        const isCurrentlyLastMessageVisible = isLastMessageVisible();\r\n\r\n                        setMessages(prevState => {\r\n                            return {...prevState, ...preparedMessages};\r\n                        });\r\n\r\n                        if (!isCurrentlyLastMessageVisible) {\r\n                            persistScrollStateFromBottom(prevScrollHeight, prevScrollTop, 0);\r\n                            displayScrollButton();\r\n                        }\r\n\r\n                        if (hasAnyIncomingMsg) {\r\n                            const lastMessageTimestamp = extractTimestampFromMessage(lastMessage);\r\n\r\n                            // Mark new message as received if visible\r\n                            if (canSeeLastMessage(messagesContainer.current)) {\r\n                                markAsReceived(lastMessageTimestamp);\r\n                            } else {\r\n                                setCurrentNewMessages(prevState => prevState+1);\r\n                            }\r\n\r\n                            // Update contact\r\n                            setPerson(prevState => {\r\n                                const nextState = prevState;\r\n                                nextState.lastMessageTimestamp = lastMessageTimestamp;\r\n                                nextState.isExpired = false;\r\n\r\n                                return nextState;\r\n                            });\r\n\r\n                            // Chat is not expired anymore\r\n                            setExpired(false);\r\n                        }\r\n                    } else {\r\n                        setCurrentNewMessages(prevState => prevState+1);\r\n                    }\r\n\r\n                    // Update last message id\r\n                    setLastMessageId(lastMessage.id);\r\n                }\r\n            }\r\n        }\r\n\r\n        const newChatMessagesEventToken = PubSub.subscribe(EVENT_TOPIC_NEW_CHAT_MESSAGES, onNewMessages);\r\n\r\n        // Status changes\r\n        const onMessageStatusChange = function (msg, data) {\r\n            if (data && isLoaded) {\r\n\r\n                // TODO: Check if message belongs to active conversation to avoid doing this unnecessarily\r\n                setMessages(prevState => {\r\n                    const newState = prevState;\r\n                    let changedAny = false;\r\n\r\n                    Object.entries(data).forEach((status) => {\r\n                        const statusMsgId = status[0];\r\n                        const statusObj = status[1];\r\n\r\n                        if (newState[statusMsgId]) {\r\n                            if (statusObj.sentTimestamp) {\r\n                                changedAny = true;\r\n                                newState[statusMsgId].sentTimestamp = statusObj.sentTimestamp;\r\n                            }\r\n\r\n                            if (statusObj.deliveredTimestamp) {\r\n                                changedAny = true;\r\n                                newState[statusMsgId].deliveredTimestamp = statusObj.deliveredTimestamp;\r\n                            }\r\n\r\n                            if (statusObj.readTimestamp) {\r\n                                changedAny = true;\r\n                                newState[statusMsgId].readTimestamp = statusObj.readTimestamp;\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    if (changedAny) {\r\n                        return {...newState};\r\n                    } else {\r\n                        return prevState;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        const chatMessageStatusChangeEventToken = PubSub.subscribe(EVENT_TOPIC_CHAT_MESSAGE_STATUS_CHANGE, onMessageStatusChange);\r\n\r\n        // Chat assignment\r\n        const onChatAssignment = function (msg, data) {\r\n            // This event always has a single message\r\n            const prepared = getFirstObject(data);\r\n            if (waId === prepared.waId) {\r\n                if (isAtBottom) {\r\n                    const prevScrollTop = messagesContainer.current.scrollTop;\r\n                    const prevScrollHeight = messagesContainer.current.scrollHeight;\r\n                    const isCurrentlyLastMessageVisible = isLastMessageVisible();\r\n\r\n                    // Display as a new message\r\n                    setMessages(prevState => {\r\n                        return {...prevState, ...data};\r\n                    });\r\n\r\n                    if (!isCurrentlyLastMessageVisible) {\r\n                        persistScrollStateFromBottom(prevScrollHeight, prevScrollTop, 0);\r\n                        displayScrollButton();\r\n                    }\r\n                } else {\r\n                    displayScrollButton();\r\n                }\r\n            }\r\n        }\r\n\r\n        const chatAssignmentEventToken = PubSub.subscribe(EVENT_TOPIC_CHAT_ASSIGNMENT, onChatAssignment);\r\n\r\n        // Chat tagging\r\n        const onChatAssignmentOrChatTagging = function (msg, data) {\r\n            // This event always has a single message\r\n            const prepared = getFirstObject(data);\r\n            if (waId === prepared.waId) {\r\n                if (isAtBottom) {\r\n                    const prevScrollTop = messagesContainer.current.scrollTop;\r\n                    const prevScrollHeight = messagesContainer.current.scrollHeight;\r\n                    const isCurrentlyLastMessageVisible = isLastMessageVisible();\r\n\r\n                    // Display as a new message\r\n                    setMessages(prevState => {\r\n                        return {...prevState, ...data};\r\n                    });\r\n\r\n                    if (!isCurrentlyLastMessageVisible) {\r\n                        persistScrollStateFromBottom(prevScrollHeight, prevScrollTop, 0);\r\n                        displayScrollButton();\r\n                    }\r\n                } else {\r\n                    displayScrollButton();\r\n                }\r\n            }\r\n        }\r\n\r\n        const chatTaggingEventToken = PubSub.subscribe(EVENT_TOPIC_CHAT_TAGGING, onChatAssignmentOrChatTagging);\r\n\r\n        return () => {\r\n            PubSub.unsubscribe(newChatMessagesEventToken);\r\n            PubSub.unsubscribe(chatMessageStatusChangeEventToken);\r\n            PubSub.unsubscribe(chatAssignmentEventToken);\r\n            PubSub.unsubscribe(chatTaggingEventToken);\r\n        }\r\n    }, [waId, messages, isLoaded, /*isLoadingMoreMessages,*/ isExpired, isAtBottom, currentNewMessages]);\r\n\r\n    useEffect(() => {\r\n        const hasNewerToLoad = lastMessageId === undefined || !messages.hasOwnProperty(lastMessageId); //(previous != null && typeof previous !== typeof undefined);\r\n        console.log(\"Has newer to load:\", hasNewerToLoad);\r\n        setAtBottom(!hasNewerToLoad);\r\n\r\n    }, [messages, lastMessageId]);\r\n\r\n    useEffect(() => {\r\n        const onUpdatePersonName = function (msg, data) {\r\n            const name = data;\r\n            setPerson(prevState => {\r\n                prevState?.setName(name);\r\n                // Assign object to a new instance to trigger change\r\n                return Object.assign(PersonClass.newInstance(), prevState);\r\n            });\r\n        }\r\n\r\n        const updatePersonNameTokenEventToken = PubSub.subscribe(EVENT_TOPIC_UPDATE_PERSON_NAME, onUpdatePersonName);\r\n\r\n        return () => {\r\n            PubSub.unsubscribe(updatePersonNameTokenEventToken);\r\n        }\r\n    }, [person]);\r\n\r\n    /*useEffect(() => {\r\n        // Scrolling to bottom on initial templates load\r\n        if (!isLoadingTemplates) {\r\n            const target = messagesContainer.current;\r\n            target.scroll({top: target.scrollHeight - SCROLL_OFFSET});\r\n        }\r\n    }, [isLoadingTemplates]);*/\r\n\r\n    const prepareFixedDateIndicator = (dateIndicators, el) => {\r\n        const curScrollTop = el.scrollTop;\r\n        let indicatorToShow;\r\n\r\n        for (let i = 0; i < dateIndicators.length; i++) {\r\n            const indicator = dateIndicators[i];\r\n            if (indicatorToShow === undefined || indicator.offsetTop <= curScrollTop) {\r\n                indicatorToShow = indicator;\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (indicatorToShow) {\r\n            setFixedDateIndicatorText(indicatorToShow.innerHTML);\r\n        }\r\n    }\r\n\r\n    const isLastMessageVisible = () => {\r\n        const el = messagesContainer.current;\r\n        return el.scrollHeight - el.scrollTop - el.clientHeight < SCROLL_LAST_MESSAGE_VISIBILITY_OFFSET;\r\n    }\r\n\r\n    const displayScrollButton = () => {\r\n        setScrollButtonVisible(true);\r\n    }\r\n\r\n    const canSeeLastMessage = (element) => {\r\n        return !(element.scrollHeight - element.scrollTop - element.clientHeight > SCROLL_LAST_MESSAGE_VISIBILITY_OFFSET);\r\n    }\r\n\r\n    const handleScrollButtonClick = () => {\r\n        if (isAtBottom) {\r\n            const el = messagesContainer.current;\r\n            el.scroll({top: el.scrollHeight - el.offsetHeight - SCROLL_OFFSET, behavior: \"smooth\"});\r\n        } else {\r\n            getMessages(false, undefined, undefined, undefined, undefined, false, true);\r\n        }\r\n\r\n        //setScrollButtonVisible(false);\r\n    }\r\n\r\n    const persistScrollStateFromBottom = (prevScrollHeight, prevScrollTop, offset) => {\r\n        const nextScrollHeight = messagesContainer.current.scrollHeight;\r\n        messagesContainer.current.scrollTop = (nextScrollHeight - prevScrollHeight) + prevScrollTop - offset;\r\n    }\r\n\r\n    const scrollToChild = (msgId) => {\r\n        setTimeout(function () {\r\n            const child = messagesContainer.current.querySelector('#message_' + msgId);\r\n            let _offset = 25;\r\n            if (child) {\r\n                let targetOffsetTop = child.offsetTop - _offset;\r\n                if (targetOffsetTop < SCROLL_OFFSET) targetOffsetTop = SCROLL_OFFSET;\r\n                messagesContainer.current.scroll({top: targetOffsetTop, behavior: \"smooth\"});\r\n\r\n                child.classList.add('blink');\r\n\r\n                setTimeout(function () {\r\n                    if (child) {\r\n                        child.classList.remove('blink');\r\n                    }\r\n                }, 1000);\r\n            }\r\n        }, 100);\r\n    }\r\n\r\n    const goToMessageId = (msgId, timestamp) => {\r\n        if (messagesContainer.current) {\r\n            if (msgId) {\r\n                if (messages[msgId]) {\r\n                    console.log(\"This message is already loaded.\");\r\n                    scrollToChild(msgId);\r\n                } else {\r\n                    console.log(\"This message will be loaded.\");\r\n\r\n                    // TODO: Cancel other messages requests first\r\n\r\n                    // Load messages since clicked results\r\n                    setLoadingMoreMessages(true);\r\n                    const callback = () => {\r\n                        scrollToChild(msgId);\r\n                    };\r\n                    getMessages(false, callback, undefined, undefined, timestamp, true, true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        const onGoToMessageId = function (msg, data) {\r\n            const msgId = data.id;\r\n            const timestamp = data.timestamp;\r\n\r\n            goToMessageId(msgId, timestamp);\r\n        }\r\n\r\n        // Subscribe for scrolling to message event\r\n        const token = PubSub.subscribe(EVENT_TOPIC_GO_TO_MSG_ID, onGoToMessageId);\r\n\r\n        return () => {\r\n            // Unsubscribe\r\n            PubSub.unsubscribe(token);\r\n        }\r\n    }, [messages, isAtBottom]);\r\n\r\n    useEffect(() => {\r\n        if (selectedFiles) {\r\n            handleChosenFiles();\r\n        }\r\n    }, [selectedFiles]);\r\n\r\n    const [optionsChatMessage, setOptionsChatMessage] = useState();\r\n    const [menuAnchorEl, setMenuAnchorEl] = useState();\r\n\r\n    const displayOptionsMenu = (event, chatMessage) => {\r\n        // We need to use parent because menu view gets hidden\r\n        setMenuAnchorEl(event.currentTarget.parentElement);\r\n        setOptionsChatMessage(chatMessage);\r\n    }\r\n\r\n    const getPerson = (loadMessages) => {\r\n        axios.get(`${BASE_URL}persons/${waId}/`, getConfig(undefined, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                //console.log(\"Person\", response.data);\r\n\r\n                const preparedPerson = new PersonClass(response.data);\r\n                setPerson(preparedPerson);\r\n                setExpired(preparedPerson.isExpired);\r\n\r\n                // Person information is loaded, now load messages\r\n                if (loadMessages !== undefined && loadMessages === true) {\r\n                    getMessages(true, function (preparedMessages) {\r\n                        setLastMessageId(getLastObject(preparedMessages)?.id);\r\n\r\n                        // Scroll to message if goToMessageId is defined\r\n                        const goToMessage = location.goToMessage;\r\n                        if (goToMessage !== undefined) {\r\n                            goToMessageId(goToMessage.id, goToMessage.timestamp);\r\n                        }\r\n                    });\r\n                }\r\n            })\r\n            .catch((error) => {\r\n                if (error.response?.status === 404) {\r\n                    if (location.person) {\r\n                        const preparedPerson = new PersonClass({});\r\n                        preparedPerson.name = location.person.name;\r\n                        preparedPerson.initials = location.person.initials;\r\n                        preparedPerson.waId = waId;\r\n\r\n                        setPerson(preparedPerson);\r\n\r\n                        setExpired(true);\r\n                        setLoaded(true);\r\n                        setLoadingMoreMessages(false);\r\n                        setAtBottom(true);\r\n                    } else {\r\n                        // To prevent missing data on refresh\r\n                        closeChat();\r\n                    }\r\n                } else {\r\n                    window.displayError(error);\r\n                }\r\n            });\r\n    }\r\n\r\n    const getMessages = (isInitial, callback, beforeTime, offset, sinceTime, isInitialWithSinceTime, replaceAll) => {\r\n        const limit = 30;\r\n\r\n        axios.get( `${BASE_URL}messages/`,\r\n            getConfig({\r\n                wa_id: waId,\r\n                offset: offset ?? 0,\r\n                before_time: beforeTime,\r\n                since_time: sinceTime,\r\n                limit: limit,\r\n            }, cancelTokenSourceRef.current.token)\r\n        )\r\n            .then((response) => {\r\n                //console.log(\"Messages\", response.data);\r\n\r\n                const count = response.data.count;\r\n                //const previous = response.data.previous;\r\n                const next = response.data.next;\r\n\r\n                if (sinceTime && isInitialWithSinceTime === true) {\r\n                    if (next) { /*count > limit*/\r\n                        setAtBottom(false);\r\n                        getMessages(false, callback, beforeTime, count - limit, sinceTime, false, replaceAll);\r\n                        return false;\r\n                    }\r\n                }\r\n\r\n                const preparedMessages = {};\r\n                response.data.results.reverse().forEach((message) => {\r\n                    const prepared = new ChatMessageClass(message);\r\n                    preparedMessages[prepared.id] = prepared;\r\n                });\r\n\r\n                const lastMessage = getLastObject(preparedMessages);\r\n\r\n                // Pagination filters for events\r\n                let beforeTimeForEvents = beforeTime;\r\n                let sinceTimeForEvents = sinceTime;\r\n\r\n                if (isInitial) {\r\n                    beforeTimeForEvents = undefined;\r\n                } else {\r\n                    if (!beforeTime) {\r\n                        beforeTimeForEvents = lastMessage?.timestamp;\r\n                    }\r\n                }\r\n\r\n                if (!sinceTime) {\r\n                    sinceTimeForEvents = getFirstObject(preparedMessages)?.timestamp;\r\n                }\r\n\r\n                // List assignment events\r\n                listChatAssignmentEvents(preparedMessages, isInitial, callback, replaceAll, beforeTime, sinceTime, beforeTimeForEvents, sinceTimeForEvents);\r\n\r\n            })\r\n            .catch((error) => {\r\n                setLoadingMoreMessages(false);\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    // Chain: getMessages -> listChatAssignmentEvents -> listChatTaggingEvents -> finishLoadingMessages\r\n    const finishLoadingMessages = (preparedMessages, isInitial, callback, replaceAll, beforeTime, sinceTime) => {\r\n\r\n        // Sort prepared messages\r\n        preparedMessages = sortMessagesAsc(preparedMessages);\r\n\r\n        if (getObjLength(preparedMessages) > 0) {\r\n            // To persist scroll position, we store current scroll information\r\n            const prevScrollTop = messagesContainer.current.scrollTop;\r\n            const prevScrollHeight = messagesContainer.current.scrollHeight;\r\n\r\n            setMessages((prevState => {\r\n                let nextState;\r\n                if (replaceAll) {\r\n                    nextState = preparedMessages;\r\n                } else {\r\n                    if (sinceTime) {\r\n                        nextState = {...prevState, ...preparedMessages}\r\n                    } else {\r\n                        nextState = {...preparedMessages, ...prevState}\r\n                    }\r\n                }\r\n\r\n                // Sort final object\r\n                return sortMessagesAsc(nextState);\r\n            }));\r\n\r\n            if (!sinceTime || replaceAll) {\r\n                persistScrollStateFromBottom(prevScrollHeight, prevScrollTop, SCROLL_OFFSET);\r\n            } else if (sinceTime) {\r\n                messagesContainer.current.scrollTop = prevScrollTop;\r\n            }\r\n        }\r\n\r\n        setLoaded(true);\r\n        setLoadingMoreMessages(false);\r\n\r\n        // TODO: Check unread messages first and then decide to do it or not\r\n        if (isInitial) {\r\n            // beforeTime is not passed only for initial request\r\n            // Mark messages as received\r\n            const lastMessageTimestamp = getLastMessageAndExtractTimestamp(preparedMessages);\r\n            markAsReceived(lastMessageTimestamp);\r\n        }\r\n\r\n        // Promise\r\n        if (callback) {\r\n            setTimeout(function () {\r\n                callback(preparedMessages);\r\n            }, 50);\r\n        }\r\n    }\r\n\r\n    const listChatAssignmentEvents = (preparedMessages, isInitial, callback, replaceAll, beforeTime, sinceTime, beforeTimeForEvents, sinceTimeForEvents) => {\r\n        axios.get(`${BASE_URL}chat_assignment_events/`, getConfig({\r\n            wa_id: waId,\r\n            before_time: beforeTimeForEvents,\r\n            since_time: sinceTimeForEvents,\r\n        }, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(\"Assignment history\", response.data);\r\n\r\n                response.data.results.reverse().forEach((assignmentEvent) => {\r\n                    const prepared = ChatMessageClass.fromAssignmentEvent(assignmentEvent);\r\n                    preparedMessages[prepared.id] = prepared;\r\n                });\r\n\r\n                // List chat tagging events\r\n                listChatTaggingEvents(preparedMessages, isInitial, callback, replaceAll, beforeTime, sinceTime, beforeTimeForEvents, sinceTimeForEvents);\r\n\r\n            })\r\n            .catch((error) => {\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const listChatTaggingEvents = (preparedMessages, isInitial, callback, replaceAll, beforeTime, sinceTime, beforeTimeForEvents, sinceTimeForEvents) => {\r\n        axios.get(`${BASE_URL}chat_tagging_events/`, getConfig({\r\n            wa_id: waId,\r\n            before_time: beforeTimeForEvents,\r\n            since_time: sinceTimeForEvents,\r\n        }, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(\"Tagging history\", response.data);\r\n\r\n                response.data.results.reverse().forEach((taggingEvent) => {\r\n                    const prepared = ChatMessageClass.fromTaggingEvent(taggingEvent);\r\n                    preparedMessages[prepared.id] = prepared;\r\n                });\r\n\r\n                // Finish loading\r\n                finishLoadingMessages(preparedMessages, isInitial, callback, replaceAll, beforeTime, sinceTime);\r\n\r\n            })\r\n            .catch((error) => {\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const resendMessage = (message) => {\r\n        console.log(message);\r\n\r\n        const successCallback = () => {\r\n            // Delete message if resent successfully\r\n            setMessages(prevState => {\r\n                delete prevState[message.id];\r\n\r\n                return {...prevState};\r\n            });\r\n        }\r\n\r\n        const resendPayload = message.resendPayload;\r\n\r\n        if (resendPayload.type === ChatMessageClass.TYPE_TEXT || resendPayload.text) {\r\n            sendMessage(undefined, resendPayload, successCallback);\r\n        } else if (resendPayload.type === ChatMessageClass.TYPE_TEMPLATE) {\r\n            sendTemplateMessage(undefined, resendPayload, successCallback);\r\n        } else {\r\n            // File\r\n            sendFile(undefined, undefined, resendPayload, successCallback);\r\n        }\r\n    }\r\n\r\n    const sendCustomTextMessage = (text) => {\r\n        sendMessage(undefined, {\r\n            wa_id: waId,\r\n            text: {\r\n                body: text.trim()\r\n            }\r\n        });\r\n    }\r\n\r\n    const bulkSendMessage = (type, payload) => {\r\n        props.setSelectionModeEnabled(true);\r\n\r\n        if (type === ChatMessageClass.TYPE_TEXT) {\r\n            const preparedInput = translateHTMLInputToText(input).trim();\r\n            payload = {\r\n                text: {\r\n                    body: preparedInput\r\n                }\r\n            };\r\n        }\r\n\r\n        props.setBulkSendPayload(payload);\r\n\r\n        // Close chat on mobile\r\n        if (isMobileOnly) {\r\n            closeChat();\r\n        }\r\n    }\r\n\r\n    const sendMessage = (e, customPayload, callback) => {\r\n        e?.preventDefault();\r\n\r\n        // Check if has internet connection\r\n        if (!hasInternetConnection()) {\r\n            window.displayCustomError('Check your internet connection.');\r\n            return false;\r\n        }\r\n\r\n        let requestBody;\r\n\r\n        if (e) {\r\n            const preparedInput = translateHTMLInputToText(input).trim();\r\n\r\n            if (preparedInput === '') {\r\n                return false;\r\n            }\r\n\r\n            console.log('You typed: ', preparedInput);\r\n\r\n            requestBody = {\r\n                wa_id: waId,\r\n                text: {\r\n                    body: preparedInput\r\n                }\r\n            };\r\n        } else if (customPayload) {\r\n            // Resend payload is being sent\r\n            requestBody = customPayload;\r\n        }\r\n\r\n        if (isLoaded) {\r\n            axios.post( `${BASE_URL}messages/`, requestBody, getConfig())\r\n                .then((response) => {\r\n                    console.log(response.data);\r\n\r\n                    // TODO: Display message immediately\r\n                    /*const messageId = response.data?.waba_response?.messages?.[0]?.id;\r\n                    setMessages(prevState => {\r\n                        const sentMessage = new ChatMessageClass();\r\n                        prevState[messageId] = sentMessage;\r\n                        return {...prevState};\r\n                    });*/\r\n\r\n                    if (callback) {\r\n                        callback();\r\n                    }\r\n                })\r\n                .catch((error) => {\r\n                    window.displayError(error);\r\n\r\n                    if (error.response) {\r\n                        const status = error.response.status;\r\n                        // Switch to expired mode if status code is 453\r\n                        if (status === 453) {\r\n                            setExpired(true);\r\n                        } else if (status === 500 || status === 502) {\r\n                            const isStored = status === 502;\r\n                            displayFailedMessage(requestBody, isStored, true);\r\n                        }\r\n\r\n                        handleIfUnauthorized();\r\n                    }\r\n                });\r\n\r\n            clearInput();\r\n\r\n            // Close emoji picker\r\n            PubSub.publish(EVENT_TOPIC_EMOJI_PICKER_VISIBILITY, false);\r\n        }\r\n    }\r\n\r\n    const sendTemplateMessage = (templateMessage, customPayload, callback) => {\r\n        let requestBody;\r\n\r\n        if (customPayload) {\r\n            requestBody = customPayload;\r\n        } else {\r\n            requestBody = generateTemplateMessagePayload(templateMessage);\r\n            requestBody.wa_id = waId;\r\n        }\r\n\r\n        if (isLoaded) {\r\n            axios.post( `${BASE_URL}messages/`, requestBody, getConfig())\r\n                .then((response) => {\r\n                    console.log(response.data);\r\n\r\n                    // Hide dialog by this event\r\n                    PubSub.publish(EVENT_TOPIC_SENT_TEMPLATE_MESSAGE, true);\r\n\r\n                    if (callback) {\r\n                        callback();\r\n                    }\r\n                })\r\n                .catch((error) => {\r\n                    window.displayError(error);\r\n\r\n                    if (error.response) {\r\n                        const errors = error.response.data?.waba_response?.errors;\r\n                        PubSub.publish(EVENT_TOPIC_SEND_TEMPLATE_MESSAGE_ERROR, errors);\r\n\r\n                        const status = error.response.status;\r\n\r\n                        if (status === 453) {\r\n                            setExpired(true);\r\n                        } else if (status === 500 || status === 502) {\r\n                            const isStored = status === 502;\r\n                            displayFailedMessage(requestBody, isStored);\r\n                        }\r\n\r\n                        handleIfUnauthorized(error);\r\n                    }\r\n                });\r\n        }\r\n    }\r\n\r\n    const displayFailedMessage = (requestBody, isStored, willClearInput) => {\r\n        setMessages(prevState => {\r\n            let text = '';\r\n\r\n            if (requestBody.type === ChatMessageClass.TYPE_TEXT || requestBody.text) {\r\n                text = requestBody.text.body;\r\n            } else if (requestBody.type === ChatMessageClass.TYPE_TEMPLATE) {\r\n                text = requestBody.template.name;\r\n            } else {\r\n                // File\r\n                text = requestBody.link;\r\n            }\r\n\r\n            const timestamp = generateUnixTimestamp();\r\n            const messageId = 'failed_' + timestamp;\r\n            const failedMessage = new ChatMessageClass();\r\n            failedMessage.id = messageId;\r\n            failedMessage.text = text;\r\n            failedMessage.isFromUs = true;\r\n            failedMessage.isFailed = true;\r\n            failedMessage.isStored = isStored;\r\n            failedMessage.timestamp = timestamp;\r\n            failedMessage.resendPayload = requestBody;\r\n\r\n            prevState[messageId] = failedMessage;\r\n            return {...prevState};\r\n        });\r\n\r\n        if (willClearInput === true) {\r\n            clearInput();\r\n        }\r\n    }\r\n\r\n    const clearInput = () => {\r\n        setInput('')\r\n    }\r\n\r\n    const sendFile = (fileURL, chosenFile, customPayload, callback) => {\r\n        let requestBody;\r\n\r\n        if (customPayload) {\r\n            requestBody = customPayload;\r\n        } else {\r\n            const caption = chosenFile.caption;\r\n            const type = chosenFile.attachmentType;\r\n            const file = chosenFile.file;\r\n            const filename = file.name;\r\n            const mimeType = file.type;\r\n\r\n            requestBody = {\r\n                wa_id: waId,\r\n                recipient_type: 'individual',\r\n                to: waId,\r\n                type: type\r\n            };\r\n\r\n            requestBody[type] = {\r\n                link: fileURL,\r\n                mime_type: mimeType,\r\n            }\r\n\r\n            // caption param is accepted for only images and videos\r\n            if (type === ATTACHMENT_TYPE_IMAGE || type === ATTACHMENT_TYPE_VIDEO) {\r\n                requestBody[type]['caption'] = caption;\r\n            }\r\n\r\n            // filename param is accepted for documents\r\n            if (type === ATTACHMENT_TYPE_DOCUMENT) {\r\n                requestBody[type]['filename'] = filename;\r\n            }\r\n        }\r\n\r\n        if (isLoaded) {\r\n            axios.post( `${BASE_URL}messages/`, requestBody, getConfig())\r\n                .then((response) => {\r\n                    console.log(response.data);\r\n\r\n                    // Send next request (or resend callback)\r\n                    callback();\r\n                })\r\n                .catch((error) => {\r\n                    window.displayError(error);\r\n\r\n                    if (error.response) {\r\n                        const status = error.response.status;\r\n\r\n                        if (status === 453) {\r\n                            setExpired(true);\r\n                        } else if (status === 500 || status === 502) {\r\n                            const isStored = status === 502;\r\n                            displayFailedMessage(requestBody, isStored);\r\n                        }\r\n\r\n                        handleIfUnauthorized(error);\r\n                    }\r\n\r\n                    // Send next when it fails, a retry can be considered\r\n                    // If custom payload is empty, it means it is resending, so it is just a success callback\r\n                    if (!customPayload) {\r\n                        callback();\r\n                    }\r\n                });\r\n        }\r\n    }\r\n\r\n    const handleChosenFiles = () => {\r\n        if (getObjLength(selectedFiles) > 0) {\r\n            const preparedFiles = prepareSelectedFiles(selectedFiles);\r\n\r\n            setPreviewSendMediaData(preparedFiles);\r\n            setPreviewSendMediaVisible(true);\r\n        }\r\n    }\r\n\r\n    const sendHandledChosenFiles = (preparedFiles) => {\r\n        if (isLoaded && preparedFiles) {\r\n            const requests = [];\r\n\r\n            // Sending all files in a loop\r\n            Object.entries(preparedFiles).forEach((curFile) => {\r\n                const curChosenFile = curFile[1];\r\n                const file = curChosenFile.file;\r\n\r\n                const formData = new FormData();\r\n                formData.append(\"file_encoded\", file);\r\n\r\n                requests.push({\r\n                    formData: formData,\r\n                    chosenFile: curChosenFile\r\n                });\r\n            });\r\n\r\n            let requestIndex = 0;\r\n\r\n            const sendRequest = (request) => {\r\n                const sendNextRequest = () => {\r\n                    requestIndex++;\r\n                    const nextRequest = requests[requestIndex];\r\n                    if (nextRequest) {\r\n                        sendRequest(nextRequest);\r\n                    }\r\n                }\r\n\r\n                axios.post(`${BASE_URL}media/`, request.formData, getConfig())\r\n                    .then((response) => {\r\n                        console.log(response.data);\r\n\r\n                        // Convert parameters to a ChosenFile object\r\n                        sendFile(response.data.file, request.chosenFile, undefined, function () {\r\n                            sendNextRequest();\r\n                        });\r\n\r\n                    })\r\n                    .catch((error) => {\r\n                        window.displayError(error);\r\n\r\n                        if (error.response) {\r\n                            if (error.response) {\r\n                                handleIfUnauthorized(error);\r\n                            }\r\n                        }\r\n\r\n                        // Send next when it fails, a retry can be considered\r\n                        sendNextRequest();\r\n                    });\r\n            }\r\n\r\n            sendRequest(requests[requestIndex]);\r\n        }\r\n    }\r\n\r\n    const handleDrop = (event) => {\r\n        if (waId) {\r\n            setSelectedFiles(getDroppedFiles(event));\r\n        } else {\r\n            event.preventDefault();\r\n        }\r\n    }\r\n\r\n    const markAsReceived = (timestamp) => {\r\n        console.log('Marking as received', timestamp);\r\n\r\n        axios.post( `${BASE_URL}mark_as_received/`, {\r\n            timestamp: timestamp,\r\n            customer_wa_id: waId\r\n        }, getConfig(undefined, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                //console.log(response.data);\r\n\r\n                PubSub.publish(EVENT_TOPIC_MARKED_AS_RECEIVED, waId);\r\n\r\n                setCurrentNewMessages(0);\r\n            })\r\n            .catch((error) => {\r\n                window.displayError(error);\r\n\r\n                if (error.response) {\r\n                    handleIfUnauthorized(error);\r\n                }\r\n            });\r\n    }\r\n\r\n    const handleIfUnauthorized = (error) => {\r\n        if (error.response.status === 401) {\r\n            props.clearUserSession(\"invalidToken\");\r\n        }\r\n    }\r\n\r\n    const closeChat = () => {\r\n        history.push(\"/main\");\r\n    }\r\n\r\n    let lastPrintedDate;\r\n    let lastSenderWaId;\r\n\r\n    return (\r\n        <div\r\n            className={\"chat\" + (waId ? \" chatOpen\" : \"\") + (props.isChatOnly ? \" chatFullWidth\" : \"\")}\r\n            onDrop={(event) => handleDrop(event)}\r\n            onDragOver={(event) => handleDragOver(event)}>\r\n\r\n            <ChatHeader\r\n                person={person}\r\n                contactProvidersData={props.contactProvidersData}\r\n                retrieveContactData={props.retrieveContactData}\r\n                isChatOnly={props.isChatOnly}\r\n                setChatAssignmentVisible={props.setChatAssignmentVisible}\r\n                setChatTagsVisible={props.setChatTagsVisible}\r\n                closeChat={closeChat} />\r\n\r\n            <Zoom in={(isLoaded && !isLoadingMoreMessages && (fixedDateIndicatorText !== undefined && fixedDateIndicatorText.trim().length > 0))}>\r\n                <div className=\"chat__body__dateIndicator\">\r\n                    <MessageDateIndicator text={fixedDateIndicatorText} />\r\n                </div>\r\n            </Zoom>\r\n\r\n            <Zoom in={(waId && !isLoaded) || isLoadingMoreMessages}>\r\n                <div className=\"chat__body__loadingMore\">\r\n                    <div className=\"chat__body__loadingMore__wrapper\">\r\n                        <CircularProgress size={28} />\r\n                    </div>\r\n                </div>\r\n            </Zoom>\r\n\r\n            <div id=\"chat__body\" className=\"chat__body\" ref={messagesContainer} onDrop={(event) => event.preventDefault()}>\r\n                <div className=\"chat__empty\"/>\r\n\r\n                { Object.entries(messages).map((message, index) => {\r\n\r\n                    // Message date is created here and passed to ChatMessage for a better performance\r\n                    const curMsgDate = moment.unix(message[1].timestamp);\r\n\r\n                    if (index === 0) {\r\n                        lastPrintedDate = undefined;\r\n                        lastSenderWaId = undefined;\r\n                    }\r\n\r\n                    let willDisplayDate = false;\r\n                    if (lastPrintedDate === undefined) {\r\n                        willDisplayDate = true;\r\n                        lastPrintedDate = moment.unix(message[1].timestamp);\r\n                    } else {\r\n                        if (!curMsgDate.isSame(lastPrintedDate, 'day')) {\r\n                            willDisplayDate = true;\r\n                        }\r\n\r\n                        lastPrintedDate = curMsgDate;\r\n                    }\r\n\r\n                    let willDisplaySender = false;\r\n                    const curSenderWaId = message[1].getUniqueSender();\r\n                    if (lastSenderWaId === undefined) {\r\n                        willDisplaySender = true;\r\n                        lastSenderWaId = message[1].getUniqueSender();\r\n                    } else {\r\n                        if (lastSenderWaId !== curSenderWaId) {\r\n                            willDisplaySender = true;\r\n                        }\r\n\r\n                        lastSenderWaId = message[1].getUniqueSender();\r\n                    }\r\n\r\n                    return (\r\n                        <ChatMessage\r\n                            key={message[0]}\r\n                            messageData={message[1]}\r\n                            displayDate={willDisplayDate}\r\n                            displaySender={willDisplaySender}\r\n                            date={curMsgDate}\r\n                            onPreview={(chatMessage) => props.previewMedia(chatMessage)}\r\n                            templates={props.templates}\r\n                            goToMessageId={goToMessageId}\r\n                            onOptionsClick={(event, chatMessage) => displayOptionsMenu(event, chatMessage)}\r\n                            contactProvidersData={props.contactProvidersData}\r\n                            retrieveContactData={props.retrieveContactData}\r\n                            resendMessage={(message) => resendMessage(message)} />\r\n                    )\r\n                }) }\r\n\r\n                <div className=\"chat__body__empty\" />\r\n\r\n            </div>\r\n\r\n            <ChatFooter\r\n                waId={waId}\r\n                currentNewMessages={currentNewMessages}\r\n                isExpired={isExpired}\r\n                input={input}\r\n                setInput={setInput}\r\n                sendMessage={sendMessage}\r\n                bulkSendMessage={bulkSendMessage}\r\n                setSelectedFiles={setSelectedFiles}\r\n                isTemplateMessagesVisible={isTemplateMessagesVisible}\r\n                setTemplateMessagesVisible={setTemplateMessagesVisible}\r\n                isSavedResponsesVisible={isSavedResponsesVisible}\r\n                setSavedResponsesVisible={setSavedResponsesVisible}\r\n                sendHandledChosenFiles={sendHandledChosenFiles}\r\n                accept={accept}\r\n                setAccept={setAccept}\r\n                isScrollButtonVisible={isScrollButtonVisible}\r\n                handleScrollButtonClick={handleScrollButtonClick}\r\n                closeChat={closeChat} />\r\n\r\n            {isTemplateMessagesVisible &&\r\n            <TemplateMessages\r\n                waId={waId}\r\n                templatesData={props.templates}\r\n                onSend={(templateMessage) => sendTemplateMessage(templateMessage)}\r\n                onBulkSend={bulkSendMessage}\r\n                isLoadingTemplates={props.isLoadingTemplates} />\r\n            }\r\n\r\n            {isSavedResponsesVisible &&\r\n            <SavedResponses\r\n                savedResponses={props.savedResponses}\r\n                deleteSavedResponse={props.deleteSavedResponse}\r\n                sendCustomTextMessage={sendCustomTextMessage} />\r\n            }\r\n\r\n            {!waId &&\r\n            <div className=\"chat__default\">\r\n                <h2>Hey</h2>\r\n                <p>Choose a contact to start a conversation</p>\r\n            </div>\r\n            }\r\n\r\n            <ChatMessageOptionsMenu\r\n                menuAnchorEl={menuAnchorEl}\r\n                setMenuAnchorEl={setMenuAnchorEl}\r\n                optionsChatMessage={optionsChatMessage}\r\n                createSavedResponse={props.createSavedResponse} />\r\n\r\n            {isPreviewSendMediaVisible &&\r\n            <PreviewSendMedia\r\n                data={previewSendMediaData}\r\n                setData={setPreviewSendMediaData}\r\n                setPreviewSendMediaVisible={setPreviewSendMediaVisible}\r\n                sendHandledChosenFiles={sendHandledChosenFiles}\r\n                accept={accept} />\r\n            }\r\n\r\n        </div>\r\n    )\r\n}","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\Sidebar.js",["340","341","342","343","344"],"import React, {useEffect, useRef, useState} from 'react';\r\nimport '../../styles/Sidebar.css';\r\nimport {Avatar, Button, Divider, IconButton, Link, Menu, MenuItem, Tab, Tabs} from \"@material-ui/core\";\r\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\r\nimport SidebarChat from \"./SidebarChat\";\r\nimport axios from \"axios\";\r\nimport {\r\n    containsLetters,\r\n    generateInitialsHelper,\r\n    getConfig,\r\n    getHubURL,\r\n    getObjLength,\r\n    isScrollable\r\n} from \"../../Helpers/Helpers\";\r\nimport {\r\n    BASE_URL,\r\n    EVENT_TOPIC_GO_TO_MSG_ID,\r\n    EVENT_TOPIC_NEW_CHAT_MESSAGES,\r\n    EVENT_TOPIC_UPDATE_PERSON_NAME\r\n} from \"../../Constants\";\r\nimport {useHistory, useParams} from \"react-router-dom\";\r\nimport SearchBar from \"../SearchBar\";\r\nimport SidebarContactResult from \"../SidebarContactResult\";\r\nimport ChatClass from \"../../ChatClass\";\r\nimport NewMessageClass from \"../../NewMessageClass\";\r\nimport PubSub from \"pubsub-js\";\r\nimport {avatarStyles} from \"../../AvatarStyles\";\r\nimport BusinessProfile from \"./BusinessProfile\";\r\nimport ChangePasswordDialog from \"./ChangePasswordDialog\";\r\nimport ChatMessageClass from \"../../ChatMessageClass\";\r\nimport SearchMessageResult from \"../SearchMessageResult\";\r\nimport {isMobile} from 'react-device-detect';\r\nimport ChatIcon from '@material-ui/icons/Chat';\r\nimport Contacts from \"../Contacts\";\r\nimport {clearContactProvidersData} from \"../../Helpers/StorageHelper\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\nimport {filterChat} from \"../../Helpers/SidebarHelper\";\r\nimport BulkSendIndicator from \"./BulkSendIndicator\";\r\nimport SelectableChatTag from \"../SelectableChatTag\";\r\n\r\nfunction Sidebar(props) {\r\n\r\n    const {waId} = useParams();\r\n    const chatsContainer = useRef(null);\r\n    const [anchorEl, setAnchorEl] = useState(null);\r\n    const [keyword, setKeyword] = useState(\"\");\r\n    const [chatMessages, setChatMessages] = useState({});\r\n    const [contactResults, setContactResults] = useState({});\r\n    const [isProfileVisible, setProfileVisible] = useState(false);\r\n    const [isContactsVisible, setContactsVisible] = useState(false);\r\n    const [isChangePasswordDialogVisible, setChangePasswordDialogVisible] = useState(false);\r\n    const [tabCase, setTabCase] = useState(\"all\")\r\n\r\n    const [isBulkSendIndicatorVisible, setBulkSendIndicatorVisible] = useState(false);\r\n\r\n    const history = useHistory();\r\n\r\n    const avatarClasses = avatarStyles();\r\n\r\n    const logOut = () => {\r\n        props.clearUserSession();\r\n        hideMenu();\r\n    }\r\n\r\n    const forceClearContactProvidersData = () => {\r\n        clearContactProvidersData();\r\n        window.location.reload();\r\n    }\r\n\r\n    const displayMenu = (event) => {\r\n        setAnchorEl(event.currentTarget);\r\n    }\r\n\r\n    const hideMenu = () => {\r\n        setAnchorEl(null);\r\n    }\r\n\r\n    let cancelTokenSourceRef = useRef();\r\n\r\n    useEffect(() => {\r\n        // Generate a token\r\n        cancelTokenSourceRef.current = axios.CancelToken.source();\r\n\r\n        getChats(cancelTokenSourceRef.current, true, undefined, true);\r\n\r\n        if (keyword.trim().length > 0) {\r\n            searchMessages(cancelTokenSourceRef.current);\r\n        }\r\n\r\n        return () => {\r\n            if (cancelTokenSourceRef.current) {\r\n                cancelTokenSourceRef.current.cancel(\"Operation canceled due to new request.\");\r\n            }\r\n        }\r\n    }, [keyword]);\r\n\r\n    useEffect(() => {\r\n        // New chatMessages\r\n        const onNewMessages = function (msg, data) {\r\n            // We don't need to update if chats are filtered\r\n            if (keyword.trim().length === 0) {\r\n                let willMakeRequest = false;\r\n\r\n                const retrieveChatWaIdList = [];\r\n\r\n                const nextState = props.chats;\r\n                let changedAny = false;\r\n\r\n                Object.entries(data).forEach((message) => {\r\n                    //const msgId = message[0];\r\n                    const chatMessage = message[1];\r\n                    const chatMessageWaId = chatMessage.waId;\r\n\r\n                    // New chat, incoming or outgoing message\r\n                    // Check if chat with waId already exists\r\n                    if (!nextState.hasOwnProperty(chatMessageWaId)) {\r\n                        willMakeRequest = true;\r\n\r\n                        // Collect waid list to retrieve chats\r\n                        if (!retrieveChatWaIdList.includes(chatMessageWaId)) {\r\n                            retrieveChatWaIdList.push(chatMessageWaId);\r\n                        }\r\n                    }\r\n\r\n                    // Chats are ordered by incoming message date\r\n                    if (nextState.hasOwnProperty(chatMessageWaId)) {\r\n                        changedAny = true;\r\n\r\n                        // Update existing chat\r\n                        nextState[chatMessageWaId].setLastMessage(chatMessage.payload);\r\n\r\n                        // Incoming\r\n                        if (!chatMessage.isFromUs) {\r\n                            // Update name and initials on incoming message if name is missing\r\n                            const chat = nextState[chatMessageWaId];\r\n                            if (chat) {\r\n                                const chatName = chat.name;\r\n                                if (!containsLetters(chatName)) {\r\n                                    // Update sidebar chat name\r\n                                    nextState[chatMessageWaId].setName(chatMessage.senderName);\r\n\r\n                                    // Check if current chat\r\n                                    if (waId === chatMessageWaId) {\r\n                                        PubSub.publish(EVENT_TOPIC_UPDATE_PERSON_NAME, chatMessage.senderName);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // New chatMessages\r\n                    if (!chatMessage.isFromUs && (waId !== chatMessageWaId || document.visibilityState === 'hidden')) {\r\n                        const preparedNewMessages = props.newMessages;\r\n                        if (props.newMessages[chatMessageWaId] === undefined) {\r\n                            preparedNewMessages[chatMessageWaId] = new NewMessageClass(chatMessageWaId, 0);\r\n                        }\r\n\r\n                        // Increase number of new chatMessages\r\n                        preparedNewMessages[chatMessageWaId].newMessages++;\r\n\r\n                        props.setNewMessages({...preparedNewMessages});\r\n\r\n                        // Display a notification\r\n                        if (!chatMessage.isFromUs) {\r\n                            props.displayNotification(\"New messages\", \"You have new messages!\", chatMessageWaId);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                // If anything has changed, sort chats\r\n                if (changedAny) {\r\n                    // Sorting\r\n                    const sortedNextState = sortChats(nextState);\r\n                    props.setChats({...sortedNextState});\r\n                }\r\n\r\n                // We do this to generate new (missing) chat\r\n                if (willMakeRequest) {\r\n                    retrieveChatWaIdList.forEach((chatMessageWaId) => {\r\n                        retrieveChat(chatMessageWaId);\r\n                    })\r\n\r\n                    //getChats(cancelTokenSourceRef.current, false, undefined, false);\r\n                }\r\n            }\r\n        }\r\n\r\n        const newChatMessagesEventToken = PubSub.subscribe(EVENT_TOPIC_NEW_CHAT_MESSAGES, onNewMessages);\r\n\r\n        return () => {\r\n            PubSub.unsubscribe(newChatMessagesEventToken);\r\n        }\r\n    }, [waId, props.chats, props.newMessages, keyword]);\r\n\r\n    useEffect(() => {\r\n        const chatsContainerCopy = chatsContainer.current;\r\n\r\n        // To optimize scroll event\r\n        let debounceTimer;\r\n\r\n        function handleScroll(e) {\r\n            if (debounceTimer) {\r\n                window.clearTimeout(debounceTimer);\r\n            }\r\n\r\n            if (keyword) {\r\n                window.clearTimeout(debounceTimer);\r\n                return false;\r\n            }\r\n\r\n            debounceTimer = setTimeout(function () {\r\n                // const threshold = 0;\r\n                const el = e.target;\r\n\r\n                if (isScrollable(el)) {\r\n                    if (el.scrollHeight - el.scrollTop - el.clientHeight < 1) {\r\n                        getChats(cancelTokenSourceRef.current, false, getObjLength(props.chats), false);\r\n                    }\r\n                }\r\n            }, 100);\r\n        }\r\n\r\n        chatsContainerCopy.addEventListener(\"scroll\", handleScroll);\r\n\r\n        return () => {\r\n            clearTimeout(debounceTimer);\r\n            chatsContainerCopy.removeEventListener(\"scroll\", handleScroll);\r\n        }\r\n    }, [props.chats, keyword]);\r\n\r\n    const search = async (_keyword) => {\r\n        setKeyword(_keyword);\r\n    }\r\n\r\n    const sortChats = (state) => {\r\n        let sortedState = Object.entries(state).sort((a, b) => b[1].lastMessageTimestamp - a[1].lastMessageTimestamp);\r\n        return Object.fromEntries(sortedState);\r\n    }\r\n\r\n    const getChats = (cancelTokenSource, isInitial, offset, replaceAll) => {\r\n        axios.get(`${BASE_URL}chats/`,\r\n            getConfig({\r\n                search: keyword,\r\n                limit: 18,\r\n                offset: offset\r\n            }, cancelTokenSource.token)\r\n        )\r\n            .then((response) => {\r\n                console.log(\"Chats\", response.data)\r\n\r\n                const preparedChats = {};\r\n                response.data.results.forEach((contact) => {\r\n                    const prepared = new ChatClass(contact);\r\n                    preparedChats[prepared.waId] = prepared;\r\n                });\r\n\r\n                props.setChats(prevState => {\r\n                    if (replaceAll) {\r\n                        return preparedChats;\r\n                    } else {\r\n                        return {...prevState, ...preparedChats};\r\n                    }\r\n                });\r\n\r\n                // In case param is undefined\r\n                isInitial = isInitial === true;\r\n\r\n                if (isInitial) {\r\n                    props.setProgress(100);\r\n                }\r\n\r\n                const willNotify = !isInitial;\r\n\r\n                const preparedNewMessages = {};\r\n                response.data.results.forEach((newMessage) => {\r\n                    const newWaId = newMessage.contact.waba_payload.wa_id;\r\n                    const newAmount = newMessage.new_messages;\r\n                    const prepared = new NewMessageClass(newWaId, newAmount);\r\n                    preparedNewMessages[prepared.waId] = prepared;\r\n                });\r\n\r\n                if (willNotify) {\r\n                    let hasAnyNewMessages = false;\r\n                    let chatMessageWaId;\r\n\r\n                    props.setNewMessages(prevState => {\r\n                            Object.entries(preparedNewMessages).forEach((newMsg) => {\r\n                                const newMsgWaId = newMsg[0]\r\n                                const number = newMsg[1].newMessages;\r\n                                if (newMsgWaId !== waId) {\r\n                                    // TODO: Consider a new contact (last part of the condition)\r\n                                    if ((prevState[newMsgWaId] && number > prevState[newMsgWaId].newMessages) /*|| (!prevState[newMsgWaId] && number > 0)*/) {\r\n                                        hasAnyNewMessages = true;\r\n\r\n                                        // There can be multiple new chats, we take first one\r\n                                        if (chatMessageWaId === newMsgWaId) chatMessageWaId = newMsgWaId;\r\n                                    }\r\n                                }\r\n                            });\r\n\r\n                            // When state is a JSON object, it is unable to understand whether it is different or same and renders again\r\n                            // So we check if new state is actually different than previous state\r\n                            if (JSON.stringify(preparedNewMessages) !== JSON.stringify(prevState)) {\r\n                                return {...prevState, ...preparedNewMessages};\r\n                            } else {\r\n                                return prevState;\r\n                            }\r\n                        }\r\n                    );\r\n\r\n                    // Display a notification\r\n                    if (hasAnyNewMessages) {\r\n                        props.displayNotification(\"New messages\", \"You have new messages!\", chatMessageWaId);\r\n                    }\r\n                } else {\r\n                    props.setNewMessages(prevState => {\r\n                        return {...prevState, ...preparedNewMessages}\r\n                    });\r\n                }\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n\r\n                if (error.response) {\r\n                    handleIfUnauthorized(error);\r\n                }\r\n            });\r\n    }\r\n\r\n    const retrieveChat = (chatWaId) => {\r\n        axios.get( `${BASE_URL}chats/${chatWaId}/`, getConfig())\r\n            .then((response) => {\r\n                console.log(\"Chat: \", response.data);\r\n\r\n                const preparedChat = new ChatClass(response.data);\r\n\r\n                props.setChats(prevState => {\r\n                    prevState[chatWaId] = preparedChat;\r\n                    const sortedNextState = sortChats(prevState);\r\n                    return {...sortedNextState};\r\n                });\r\n            })\r\n            .catch((error) => {\r\n                window.displayError(error);\r\n\r\n                if (error.response) {\r\n                    handleIfUnauthorized(error);\r\n                }\r\n            });\r\n    }\r\n\r\n    const searchMessages = (cancelTokenSource) => {\r\n        axios.get( `${BASE_URL}messages/`,\r\n            getConfig({\r\n                //offset: offset ?? 0,\r\n                limit: 30,\r\n                search: keyword\r\n            }, cancelTokenSource.token)\r\n        )\r\n            .then((response) => {\r\n                console.log(\"Messages\", response.data);\r\n\r\n                const preparedMessages = {};\r\n                response.data.results.forEach((message) => {\r\n                    const prepared = new ChatMessageClass(message);\r\n                    preparedMessages[prepared.id] = prepared;\r\n                });\r\n\r\n                setChatMessages(preparedMessages);\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n\r\n                if (error.response) {\r\n                    handleIfUnauthorized(error);\r\n                }\r\n            });\r\n    }\r\n\r\n    const goToMessage = (chatMessage) => {\r\n        if (waId !== chatMessage.waId) {\r\n            history.push({\r\n                'pathname': `/main/chat/${chatMessage.waId}`,\r\n                'goToMessage': chatMessage,\r\n            });\r\n        } else {\r\n            PubSub.publish(EVENT_TOPIC_GO_TO_MSG_ID, chatMessage);\r\n        }\r\n    }\r\n\r\n    const handleIfUnauthorized = (error) => {\r\n        if (error.response.status === 401) {\r\n            props.clearUserSession(\"invalidToken\");\r\n        }\r\n    }\r\n\r\n    const displayEditBusinessProfile = () => {\r\n        setAnchorEl(null);\r\n        props.setBusinessProfileVisible(true);\r\n    }\r\n\r\n    const goToSettings = () => {\r\n        setAnchorEl(null);\r\n        if (window.AndroidWebInterface) {\r\n            window.AndroidWebInterface.goToSettings();\r\n        }\r\n    }\r\n\r\n    const showChangePassword = () => {\r\n        setAnchorEl(null);\r\n        setChangePasswordDialogVisible(true);\r\n    }\r\n\r\n    const showChatTagsList = () => {\r\n        setAnchorEl(null);\r\n        props.setChatTagsListVisible(true);\r\n    }\r\n\r\n    const displayContacts = () => {\r\n        setContactsVisible(true);\r\n    }\r\n\r\n    const handleTabChange = (event, newValue) => {\r\n        setTabCase(newValue);\r\n    }\r\n\r\n    const clearFilter = () => {\r\n        props.setFilterTag(undefined);\r\n    }\r\n\r\n    const cancelSelection = () => {\r\n        props.setSelectionModeEnabled(false);\r\n        props.setSelectedChats([]);\r\n        props.setSelectedTags([]);\r\n    }\r\n\r\n    const finishBulkSendMessage = () => {\r\n        props.setSelectionModeEnabled(false);\r\n        props.finishBulkSendMessage();\r\n    }\r\n\r\n    return (\r\n        <div className={\"sidebar\" + (props.isChatOnly ? \" hidden\" : \"\")}>\r\n            <div className=\"sidebar__header\">\r\n                <Avatar\r\n                    onClick={() => setProfileVisible(true)}\r\n                    className={\"cursorPointer \" + (props.currentUser ? avatarClasses[generateInitialsHelper(props.currentUser.username)?.[0]] : '')}>\r\n                    {props.currentUser ? generateInitialsHelper(props.currentUser.username) : ''}\r\n                </Avatar>\r\n                <div className=\"sidebar__headerRight\">\r\n                    <IconButton onClick={displayContacts}>\r\n                        <ChatIcon />\r\n                    </IconButton>\r\n                    <IconButton onClick={displayMenu}>\r\n                        <MoreVertIcon />\r\n                    </IconButton>\r\n                </div>\r\n            </div>\r\n\r\n            <SearchBar onChange={(_keyword) => search(_keyword)} />\r\n\r\n            {props.filterTag &&\r\n            <div className=\"sidebar__clearFilter\" onClick={clearFilter}>\r\n                <CloseIcon />\r\n                Clear filter:&nbsp;\r\n                <span className=\"bold\">{props.filterTag.name}</span>\r\n            </div>\r\n            }\r\n\r\n            <div className=\"sidebar__tabs\">\r\n                <Tabs\r\n                    textColor=\"primary\"\r\n                    indicatorColor=\"primary\"\r\n                    variant={\"fullWidth\"}\r\n                    value={tabCase}\r\n                    scrollButtons=\"auto\"\r\n                    onChange={handleTabChange}>\r\n\r\n                    <Tab label={\"All\"} value={\"all\"} />\r\n                    <Tab label={\"Me\"} value={\"me\"} />\r\n                    <Tab label={\"Group\"} value={\"group\"} />\r\n\r\n                </Tabs>\r\n            </div>\r\n\r\n            <div\r\n                className=\"sidebar__results\"\r\n                ref={chatsContainer}>\r\n\r\n                {props.isSelectionModeEnabled &&\r\n                <div className=\"sidebar__results__selectionActions\">\r\n                    <Button color=\"secondary\" onClick={cancelSelection}>Cancel</Button>\r\n                    <Button color=\"primary\" onClick={finishBulkSendMessage}>Send</Button>\r\n                </div>\r\n                }\r\n\r\n                {(props.isSelectionModeEnabled && props.tags) &&\r\n                <h3>Tags</h3>\r\n                }\r\n\r\n                {(props.isSelectionModeEnabled && props.tags) &&\r\n                <div>\r\n                    { Object.entries(props.tags).map((tag) =>\r\n                        <SelectableChatTag key={tag[0]} data={tag[1]} />\r\n                    )}\r\n                </div>\r\n                }\r\n\r\n                {(keyword.trim().length > 0 || props.isSelectionModeEnabled) &&\r\n                <h3>Chats</h3>\r\n                }\r\n\r\n                <div className=\"sidebar__results__chats\">\r\n                    { Object.entries(props.chats)\r\n                        .filter((chat) => {\r\n                            // Filter by helper method\r\n                            return filterChat(props, tabCase, chat[1]);\r\n                        })\r\n                        .map((chat) =>\r\n                            <SidebarChat\r\n                                key={chat[0]}\r\n                                chatData={chat[1]}\r\n                                newMessages={props.newMessages}\r\n                                keyword={keyword}\r\n                                contactProvidersData={props.contactProvidersData}\r\n                                retrieveContactData={props.retrieveContactData}\r\n                                tabCase={tabCase}\r\n                                isSelectionModeEnabled={props.isSelectionModeEnabled}\r\n                                setSelectedChats={props.setSelectedChats} />\r\n                        )}\r\n\r\n                    { Object.keys(props.chats).length === 0 &&\r\n                    <span className=\"sidebar__results__chats__noResult\">\r\n                        {keyword.trim().length > 0 ?\r\n                            <span>No chats found for: <span className=\"searchOccurrence\">{keyword}</span></span>\r\n                            :\r\n                            <span>You don't have any chats yet.</span>\r\n                        }\r\n                    </span>\r\n                    }\r\n                </div>\r\n\r\n                {(keyword.trim().length > 0 && getObjLength(contactResults) > 0) &&\r\n                <h3>Contacts</h3>\r\n                }\r\n\r\n                {(keyword.trim().length > 0 && getObjLength(contactResults) > 0) &&\r\n                <div className=\"sidebar__results__contacts\">\r\n                    { Object.entries(contactResults).map((contactResult) =>\r\n                        <SidebarContactResult\r\n                            key={contactResult[0]}\r\n                            chatData={contactResult[1]}\r\n                        />\r\n                    )}\r\n                </div>\r\n                }\r\n\r\n                {(keyword.trim().length > 0 && getObjLength(chatMessages) > 0) &&\r\n                <h3>Messages</h3>\r\n                }\r\n\r\n                {(keyword.trim().length > 0 && getObjLength(chatMessages) > 0) &&\r\n                <div className=\"sidebar__results__messages\">\r\n                    { Object.entries(chatMessages).map((message) =>\r\n                        <SearchMessageResult\r\n                            key={message[0]}\r\n                            waId={waId}\r\n                            messageData={message[1]}\r\n                            keyword={keyword}\r\n                            displaySender={true}\r\n                            onClick={(chatMessage) => goToMessage(chatMessage)} />\r\n                    )}\r\n                </div>\r\n                }\r\n            </div>\r\n\r\n            {isContactsVisible &&\r\n            <Contacts\r\n                contactProvidersData={props.contactProvidersData}\r\n                onHide={() => setContactsVisible(false)} />\r\n            }\r\n\r\n            {isProfileVisible &&\r\n            <BusinessProfile\r\n                isAdmin={props.isAdmin}\r\n                currentUser={props.currentUser}\r\n                onHide={() => setProfileVisible(false)}\r\n                displayEditBusinessProfile={displayEditBusinessProfile}\r\n                setChangePasswordDialogVisible={setChangePasswordDialogVisible} />\r\n            }\r\n\r\n            {isBulkSendIndicatorVisible &&\r\n            <BulkSendIndicator/>\r\n            }\r\n\r\n            <Menu\r\n                anchorEl={anchorEl}\r\n                getContentAnchorEl={null}\r\n                anchorOrigin={{ vertical: \"bottom\", horizontal: \"right\" }}\r\n                transformOrigin={{ vertical: \"top\", horizontal: \"right\" }}\r\n                keepMounted\r\n                open={Boolean(anchorEl)}\r\n                onClose={hideMenu}\r\n                elevation={3}>\r\n                <MenuItem onClick={showChatTagsList}>Tags</MenuItem>\r\n                <Divider />\r\n                <MenuItem className=\"sidebar__menu__refresh\" onClick={() => window.location.reload()}>Refresh</MenuItem>\r\n                <MenuItem onClick={showChangePassword}>Change password</MenuItem>\r\n                <MenuItem onClick={forceClearContactProvidersData}>Refresh contacts</MenuItem>\r\n                {props.isAdmin &&\r\n                <Divider />\r\n                }\r\n                {props.isAdmin &&\r\n                <MenuItem component={Link} href={getHubURL()} target=\"_blank\" color=\"initial\">Admin panel</MenuItem>\r\n                }\r\n                {isMobile &&\r\n                <MenuItem onClick={goToSettings}>Settings (App Only)</MenuItem>\r\n                }\r\n                <Divider />\r\n                <MenuItem onClick={logOut}>Logout</MenuItem>\r\n            </Menu>\r\n\r\n            <ChangePasswordDialog\r\n                open={isChangePasswordDialogVisible}\r\n                setOpen={setChangePasswordDialogVisible} />\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Sidebar","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageTypeIcon.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatHeader.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessage.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatFooter.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\SidebarChat.js",["345","346"],"import React, {useEffect, useState} from 'react';\r\nimport '../../styles/SidebarChat.css';\r\nimport {Avatar, Checkbox, ListItem, Tooltip} from \"@material-ui/core\";\r\nimport {useHistory, useParams} from \"react-router-dom\";\r\nimport LabelIcon from '@material-ui/icons/Label';\r\nimport GroupIcon from '@material-ui/icons/Group';\r\nimport Moment from \"react-moment\";\r\nimport {avatarStyles} from \"../../AvatarStyles\";\r\nimport moment from \"moment\";\r\nimport {\r\n    addPlus,\r\n    extractAvatarFromContactProviderData,\r\n    generateInitialsHelper,\r\n    markOccurrences,\r\n    replaceEmojis\r\n} from \"../../Helpers\";\r\nimport {getDroppedFiles, handleDragOver} from \"../../FileHelpers\";\r\nimport PubSub from \"pubsub-js\";\r\nimport {CALENDAR_SHORT, EVENT_TOPIC_DROPPED_FILES} from \"../../Constants\";\r\nimport ChatMessageShortContent from \"../Chat/ChatMessage/ChatMessageShortContent\";\r\n\r\nfunction SidebarChat(props) {\r\n\r\n    const history = useHistory();\r\n\r\n    const [isSelected, setSelected] = useState(false);\r\n    const [isExpired, setExpired] = useState(props.chatData.isExpired);\r\n    const [timeLeft, setTimeLeft] = useState();\r\n    const [remainingSeconds, setRemainingSeconds] = useState();\r\n    const {waId} = useParams();\r\n    const avatarClasses = avatarStyles();\r\n\r\n    useEffect(() => {\r\n        props.retrieveContactData(props.chatData.waId);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        // Set chat unselected, if selection mode is off\r\n        if (!props.isSelectionModeEnabled) {\r\n            setSelected(false);\r\n        }\r\n    }, [props.isSelectionModeEnabled]);\r\n\r\n    const generateTagNames = () => {\r\n        const generatedTagNames = [];\r\n        props.chatData.tags?.forEach((tag) => {\r\n            generatedTagNames.push(tag.name);\r\n        });\r\n        return generatedTagNames.join(', ');\r\n    }\r\n\r\n    useEffect(() => {\r\n        function calculateRemaining() {\r\n            const momentDate = moment.unix(props.chatData.lastReceivedMessageTimestamp);\r\n            momentDate.add(1, 'day');\r\n            const curDate = moment(new Date());\r\n            const hours = momentDate.diff(curDate, 'hours');\r\n            const seconds = momentDate.diff(curDate, 'seconds');\r\n\r\n            setRemainingSeconds(seconds);\r\n\r\n            let suffix;\r\n\r\n            if (hours > 0) {\r\n                suffix = 'h';\r\n                setTimeLeft(hours + suffix);\r\n            } else {\r\n                const minutes = momentDate.diff(curDate, 'minutes');\r\n                if (minutes > 1) {\r\n                    suffix = 'm';\r\n                    setTimeLeft(minutes + suffix);\r\n                } else {\r\n                    if (seconds > 1) {\r\n                        suffix = 'm';\r\n                        setTimeLeft(minutes + suffix);\r\n                    } else {\r\n                        // Expired\r\n                        setExpired(true);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        setExpired(props.chatData.isExpired);\r\n\r\n        // Initial\r\n        calculateRemaining();\r\n\r\n        let intervalId;\r\n        if (!isExpired) {\r\n            intervalId = setInterval(() => {\r\n                calculateRemaining();\r\n            }, 30000);\r\n        }\r\n\r\n        return () => {\r\n            clearInterval(intervalId);\r\n        }\r\n    }, [isExpired, props.chatData.isExpired, props.chatData.lastMessageTimestamp]);\r\n\r\n    const handleDroppedFiles = (event) => {\r\n        if (isExpired) {\r\n            event.preventDefault();\r\n            return;\r\n        }\r\n\r\n        // Preparing dropped files\r\n        const files = getDroppedFiles(event);\r\n\r\n        // Switching to related chat\r\n        history.push(`/main/chat/${props.chatData.waId}`);\r\n\r\n        // Sending files via eventbus\r\n        PubSub.publish(EVENT_TOPIC_DROPPED_FILES, files);\r\n    }\r\n\r\n    const handleClick = () => {\r\n        if (props.isSelectionModeEnabled) {\r\n            let newSelectedState;\r\n            setSelected(prevState => {\r\n                newSelectedState = !prevState;\r\n                return newSelectedState;\r\n            });\r\n\r\n            props.setSelectedChats(prevState => {\r\n                if (newSelectedState) {\r\n                    if (!prevState.includes(props.chatData.waId)) {\r\n                        prevState.push(props.chatData.waId);\r\n                    }\r\n                } else {\r\n                    prevState = prevState.filter(arrayItem => arrayItem !== props.chatData.waId);\r\n                }\r\n\r\n                return [...prevState];\r\n            });\r\n\r\n        } else {\r\n            history.push(`/main/chat/${props.chatData.waId}`);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <ListItem button onClick={handleClick}>\r\n            <div\r\n                id={props.chatData.waId}\r\n                className={\r\n                    'sidebarChatWrapper '\r\n                    + (waId === props.chatData.waId ? 'activeChat ' : '') + (isExpired ? 'expired ' : (remainingSeconds < 8 * 60 * 60 ? 'almostExpired ' : ''))\r\n                    + (props.isSelectionModeEnabled && isSelected ? 'isSelected ' : '')\r\n                }\r\n                onDrop={(event) => handleDroppedFiles(event)}\r\n                onDragOver={(event) => handleDragOver(event)}>\r\n\r\n                <div className=\"sidebarChat\">\r\n\r\n                    {props.isSelectionModeEnabled &&\r\n                    <Checkbox className=\"sidebarChat__selection\" checked={isSelected} color=\"primary\"/>\r\n                    }\r\n\r\n                    <div className=\"sidebarChat__avatarWrapper\">\r\n                        <Avatar src={extractAvatarFromContactProviderData(props.contactProvidersData[props.chatData.waId])}\r\n                                className={isExpired ? '' : avatarClasses[props.chatData.getAvatarClassName()]}>\r\n                            {props.chatData.initials}\r\n                        </Avatar>\r\n\r\n                        {(props.chatData.assignedToUser && ((props.tabCase === 'all') || (props.tabCase === 'group'))) &&\r\n                        <Tooltip title={props.chatData.generateAssignmentInformation()}>\r\n                            <Avatar className={\"sidebarChat__avatarWrapper__assignee \" + avatarClasses[props.chatData.generateAssignedToInitials()]}>\r\n                                {generateInitialsHelper(props.chatData.generateAssignedToInitials())}\r\n                            </Avatar>\r\n                        </Tooltip>\r\n                        }\r\n\r\n                        {(props.chatData.assignedGroup\r\n                            && ((props.tabCase === 'all' && !props.chatData.assignedToUser) || (props.tabCase === 'me') || (props.tabCase === 'group' && !props.chatData.assignedToUser))) &&\r\n                        <Tooltip title={props.chatData.generateAssignmentInformation()}>\r\n                            <Avatar className={\"sidebarChat__avatarWrapper__assignee \" + avatarClasses[props.chatData.generateAssignedGroupInitials()]}>\r\n                                <GroupIcon />\r\n                            </Avatar>\r\n                        </Tooltip>\r\n                        }\r\n                    </div>\r\n\r\n                    <div className=\"sidebarChat__info\">\r\n\r\n                        <div className=\"sidebarChat__info__nameWrapper\">\r\n                            <h2>\r\n                                {(props.keyword !== undefined && props.keyword.trim().length > 0)\r\n                                    ?\r\n                                    <span dangerouslySetInnerHTML={{__html: markOccurrences(replaceEmojis(props.chatData.name), props.keyword)}}/>\r\n                                    :\r\n                                    <span dangerouslySetInnerHTML={{__html: replaceEmojis(props.contactProvidersData[props.chatData.waId]?.[0]?.name ?? props.chatData.name)}} />\r\n                                }\r\n\r\n                                {props.chatData.tags?.length > 0 &&\r\n                                <div className=\"sidebarChat__info__tags\">\r\n                                    <Tooltip title={generateTagNames()}>\r\n                                        <LabelIcon className={props.chatData.tags.length > 1 ? \"multiple\" : \"\"} style={{fill: props.chatData.tags[0].web_inbox_color}} />\r\n                                    </Tooltip>\r\n                                </div>\r\n                                }\r\n                            </h2>\r\n\r\n                            <div className=\"sidebarChat__info__date\">\r\n                                {props.chatData.lastMessageTimestamp &&\r\n                                <Moment\r\n                                    className=\"sidebarChat__info__nameWrapper__lastMessageDate\"\r\n                                    date={props.chatData.lastMessageTimestamp}\r\n                                    calendar={CALENDAR_SHORT}\r\n                                    unix />\r\n                                }\r\n\r\n                                {!isExpired &&\r\n                                <span className=\"sidebarChat__info__date__timeLeft\">{timeLeft} left</span>\r\n                                }\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"sidebarChat__info__lastMessage\">\r\n                            {((props.newMessages[props.chatData.waId]?.newMessages ?? 0) > 0 /*&& waId !== props.chatData.waId*/)\r\n                                ?\r\n                                <div className=\"sidebarChat__info__lastMessage__new\">\r\n                                    {props.newMessages[props.chatData.waId]?.newMessages} new message(s)\r\n                                </div>\r\n                                :\r\n                                <div className=\"sidebarChat__info__lastMessage__body\">\r\n                                    <ChatMessageShortContent\r\n                                        type={props.chatData.lastMessageType}\r\n                                        buttonText={props.chatData.lastMessageButtonText}\r\n                                        text={props.chatData.lastMessageBody}\r\n                                        caption={props.chatData.lastMessageCaption}\r\n                                        isLastMessageFromUs={props.chatData.isLastMessageFromUs } />\r\n                                </div>\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <span className=\"sidebarChatWrapper__waId\">{addPlus(props.chatData.waId)}</span>\r\n\r\n            </div>\r\n        </ListItem>\r\n    )\r\n}\r\n\r\nexport default SidebarChat","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageOptionsMenu.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\BusinessProfile.js",["347"],"import React, {useEffect, useRef, useState} from \"react\";\r\nimport '../../styles/BusinessProfile.css';\r\nimport {Avatar, Button, FormControl, IconButton, InputLabel, MenuItem, Select, TextField} from \"@material-ui/core\";\r\nimport {ArrowBack} from \"@material-ui/icons\";\r\nimport axios from \"axios\";\r\nimport {BASE_URL} from \"../../Constants\";\r\nimport {generateInitialsHelper, getConfig} from \"../../Helpers\";\r\nimport FileInput from \"../FileInput\";\r\nimport {avatarStyles} from \"../../AvatarStyles\";\r\n\r\nfunction BusinessProfile(props) {\r\n\r\n    const [isLoaded, setLoaded] = useState(false);\r\n    const [isUpdating, setUpdating] = useState(false);\r\n    const [address, setAddress] = useState('');\r\n    const [description, setDescription] = useState('');\r\n    const [email, setEmail] = useState('');\r\n    const [vertical, setVertical] = useState('');\r\n    const [websites, setWebsites] = useState({});\r\n    const [about, setAbout] = useState('');\r\n    const [profilePhoto, setProfilePhoto] = useState();\r\n\r\n    const fileInput = useRef();\r\n\r\n    const cancelTokenSourceRef = useRef();\r\n\r\n    const avatarClasses = avatarStyles();\r\n\r\n    useEffect(() => {\r\n        const handleKey = (event) => {\r\n            if (event.keyCode === 27) { // Escape\r\n                props.onHide();\r\n            }\r\n        }\r\n\r\n        document.addEventListener('keydown', handleKey);\r\n\r\n        // Generate a token\r\n        cancelTokenSourceRef.current = axios.CancelToken.source();\r\n\r\n        getBusinessProfile();\r\n\r\n        return () => {\r\n            document.removeEventListener('keydown', handleKey);\r\n            cancelTokenSourceRef.current.cancel();\r\n        }\r\n    }, []);\r\n\r\n    const getBusinessProfile = () => {\r\n        axios.get(`${BASE_URL}settings/business/profile/`, getConfig(undefined, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(response.data);\r\n\r\n                const data = response.data;\r\n\r\n                setAddress(data.address);\r\n                setDescription(data.description);\r\n                setEmail(data.email);\r\n                setVertical(data.vertical);\r\n\r\n                let websitesArray = data.websites;\r\n                if (websitesArray.length === 0) {\r\n                    websitesArray = [];\r\n                }\r\n\r\n                setWebsites({...websitesArray});\r\n\r\n                // Load about\r\n                getAbout();\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const updateBusinessProfile = async event => {\r\n        event.preventDefault();\r\n\r\n        setUpdating(true);\r\n\r\n        axios.patch( `${BASE_URL}settings/business/profile/`, {\r\n            address: address,\r\n            description: description,\r\n            email: email,\r\n            vertical: vertical,\r\n            websites: Object.values(websites)\r\n        }, getConfig(undefined, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(response.data);\r\n\r\n                // Update about\r\n                updateAbout(event);\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n\r\n                setUpdating(false);\r\n\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const getAbout = () => {\r\n        axios.get(`${BASE_URL}settings/profile/about/`, getConfig(undefined, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(response.data);\r\n\r\n                const profile = response.data.settings?.profile;\r\n\r\n                setAbout(profile?.about?.text);\r\n\r\n                getProfilePhoto();\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const updateAbout = async event => {\r\n        event.preventDefault();\r\n\r\n        axios.patch( `${BASE_URL}settings/profile/about/`, {\r\n            text: about\r\n        }, getConfig(undefined, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(response.data);\r\n\r\n                setUpdating(false);\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n\r\n                setUpdating(false);\r\n\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const getProfilePhoto = () => {\r\n        axios.get(`${BASE_URL}settings/profile/photo/`, getConfig(undefined, cancelTokenSourceRef.current.token, 'arraybuffer'))\r\n            .then((response) => {\r\n                const base64 = Buffer.from(response.data, 'binary').toString('base64');\r\n                setProfilePhoto(base64);\r\n\r\n                // Finish\r\n                setLoaded(true);\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n\r\n                // No photo\r\n                if (error?.response?.status === 404) {\r\n                    // Finish\r\n                    setLoaded(true);\r\n                } else {\r\n                    window.displayError(error);\r\n                }\r\n            });\r\n    }\r\n\r\n    const updateProfilePhoto = async (file) => {\r\n        const formData = new FormData();\r\n        formData.append(\"file_encoded\", file[0]);\r\n\r\n        axios.post( `${BASE_URL}settings/profile/photo/`, formData, getConfig(undefined, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                console.log(response.data);\r\n\r\n                setUpdating(false);\r\n\r\n                // Display new photo\r\n                getProfilePhoto();\r\n\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n\r\n                setUpdating(false);\r\n\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const deleteProfilePhoto = () => {\r\n        axios.delete(`${BASE_URL}settings/profile/photo/`, getConfig(undefined, cancelTokenSourceRef.current.token))\r\n            .then((response) => {\r\n                setProfilePhoto(undefined);\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const verticalOptions = [\r\n        \"Automotive\", \"Beauty, Spa and Salon\",\r\n        \"Clothing and Apparel\",\r\n        \"Education\",\r\n        \"Entertainment\",\r\n        \"Event Planning and Service\",\r\n        \"Finance and Banking\",\r\n        \"Food and Grocery\",\r\n        \"Public Service\",\r\n        \"Hotel and Lodging\",\r\n        \"Medical and Health\",\r\n        \"Non-profit\",\r\n        \"Professional Services\",\r\n        \"Shopping and Retail\",\r\n        \"Travel and Transportation\",\r\n        \"Restaurant\",\r\n        \"Other\"\r\n    ];\r\n\r\n    const handleBusinessProfileAvatarClick = () => {\r\n        if (props.isAdmin) fileInput.current.click();\r\n    }\r\n\r\n    return(\r\n        <div className=\"sidebarBusinessProfile\">\r\n            <div className=\"sidebarBusinessProfile__header\">\r\n                <IconButton onClick={props.onHide}>\r\n                    <ArrowBack />\r\n                </IconButton>\r\n\r\n                <h3>Profile</h3>\r\n            </div>\r\n\r\n            <div className=\"sidebarBusinessProfile__body\">\r\n                <div className=\"sidebarBusinessProfile__body__section\">\r\n                    {props.currentUser &&\r\n                    <div>\r\n                        <div className=\"sidebarBusinessProfile__body__section__header\">\r\n                            <h5>Personal Profile</h5>\r\n                        </div>\r\n\r\n                        <div className=\"sidebarBusinessProfile__body__avatarContainer\">\r\n                            <Avatar className={avatarClasses[generateInitialsHelper(props.currentUser.username)?.[0]]}>{generateInitialsHelper(props.currentUser.username)}</Avatar>\r\n                        </div>\r\n\r\n                        <h3>{props.currentUser.username}</h3>\r\n                        <span>{props.currentUser.first_name + ' ' + props.currentUser.last_name}</span>\r\n\r\n                        <div className=\"sidebarBusinessProfile__body__changePasswordContainer\">\r\n                            <Button onClick={() => props.setChangePasswordDialogVisible(true)} color=\"secondary\">Change password</Button>\r\n                        </div>\r\n                    </div>\r\n                    }\r\n                </div>\r\n\r\n                <div className=\"sidebarBusinessProfile__body__section\">\r\n                    <div className=\"sidebarBusinessProfile__body__section__header\">\r\n                        <h5>Business Profile</h5>\r\n                    </div>\r\n\r\n                    {!isLoaded &&\r\n                    <span>Loading</span>\r\n                    }\r\n\r\n                    {isLoaded &&\r\n                    <div className=\"sidebarBusinessProfile__body__section__subSection\">\r\n\r\n                        <div className={\"sidebarBusinessProfile__body__avatarContainer\" + (props.isAdmin ? \" editable\" : \"\")}>\r\n                            <FileInput innerRef={fileInput} handleSelectedFiles={(file) => updateProfilePhoto(file)} accept=\"image/jpeg, image/png\" multiple={false} />\r\n                            <Avatar src={profilePhoto ? \"data:image/png;base64,\" + profilePhoto : undefined} onClick={handleBusinessProfileAvatarClick} />\r\n\r\n                            {(profilePhoto && props.isAdmin) &&\r\n                            <Button onClick={deleteProfilePhoto} color=\"secondary\">Delete profile photo</Button>\r\n                            }\r\n                        </div>\r\n\r\n                        <form onSubmit={updateBusinessProfile}>\r\n                            <div>\r\n                                <TextField value={about} onChange={e => setAbout(e.target.value)} label=\"About\" size=\"medium\" multiline={true} fullWidth={true} InputProps={{readOnly: !props.isAdmin}} />\r\n                                <TextField value={address} onChange={e => setAddress(e.target.value)} label=\"Address\" size=\"medium\" fullWidth={true} InputProps={{readOnly: !props.isAdmin}} />\r\n                                <TextField value={description} onChange={e => setDescription(e.target.value)} label=\"Description\" size=\"medium\" fullWidth={true} InputProps={{readOnly: !props.isAdmin}} />\r\n                                <TextField value={email} onChange={e => setEmail(e.target.value)} label=\"E-mail\" size=\"medium\" fullWidth={true} InputProps={{readOnly: !props.isAdmin}} />\r\n\r\n                                <FormControl fullWidth={true} disabled={!props.isAdmin}>\r\n                                    <InputLabel id=\"vertical-label\">Vertical</InputLabel>\r\n                                    <Select value={vertical} onChange={(event) => setVertical(event.target.value)} labelId=\"vertical-label\">\r\n                                        <MenuItem value=\"\">None</MenuItem>\r\n\r\n                                        {verticalOptions.map((verticalOption, index) =>\r\n                                            <MenuItem key={index} value={verticalOption}>{verticalOption}</MenuItem>\r\n                                        )}\r\n                                    </Select>\r\n                                </FormControl>\r\n                            </div>\r\n\r\n                            {props.isAdmin &&\r\n                            <div className=\"sidebarBusinessProfile__body__section__subSection__action\">\r\n                                <Button type=\"submit\" disabled={isUpdating} color=\"primary\" size=\"large\">Update</Button>\r\n                            </div>\r\n                            }\r\n                        </form>\r\n                    </div>\r\n                    }\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default BusinessProfile;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\ChangePasswordDialog.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageVideo.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageDocument.js",["348"],"import React from \"react\";\r\nimport InsertDriveFileIcon from \"@material-ui/icons/InsertDriveFile\";\r\n\r\nfunction ChatMessageDocument(props) {\r\n    return (\r\n        <a href={props.data.documentLink ?? props.data.getHeaderFileLink('document')} target=\"_blank\" className=\"chat__document\">\r\n            <InsertDriveFileIcon fontSize=\"small\" />\r\n            <span className=\"chat__document__filename\">{props.data.documentCaption ?? (props.data.documentFileName ?? 'Document')}</span>\r\n        </a>\r\n    )\r\n}\r\n\r\nexport default ChatMessageDocument;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageImage.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageVoice.js",["349"],"import React, {useEffect, useRef, useState} from \"react\";\r\nimport {Avatar, IconButton} from \"@material-ui/core\";\r\nimport PauseIcon from \"@material-ui/icons/Pause\";\r\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\r\nimport HeadsetIcon from \"@material-ui/icons/Headset\";\r\nimport PubSub from \"pubsub-js\";\r\nimport {EVENT_TOPIC_CHAT_MESSAGE, EVENT_TOPIC_UNSUPPORTED_FILE} from \"../../../Constants\";\r\nimport {avatarStyles} from \"../../../AvatarStyles\";\r\nimport {isAudioMimeTypeSupported} from \"../../../FileHelpers\";\r\nimport UnsupportedFileClass from \"../../../UnsupportedFileClass\";\r\n\r\nfunction ChatMessageVoice(props) {\r\n\r\n    const data = props.data;\r\n\r\n    const [isPlaying, setPlaying] = useState(false);\r\n    const duration = useRef(null);\r\n    const [progress, setProgress] = useState(0);\r\n    const [currentDuration, setCurrentDuration] = useState(\"0:00\");\r\n    const audio = useRef(null);\r\n    const range = useRef(null);\r\n\r\n    const onChatMessageEvent = function (msg, data) {\r\n        if (data === 'pause') {\r\n            pauseVoice();\r\n        }\r\n    };\r\n\r\n    const avatarClasses = avatarStyles();\r\n\r\n    const playIconStyles = {\r\n        fontSize: '38px'\r\n    };\r\n\r\n    useEffect(() => {\r\n        // Subscribing only if there is voice or audio\r\n        if (data.hasAnyAudio()) {\r\n            const token = PubSub.subscribe(EVENT_TOPIC_CHAT_MESSAGE, onChatMessageEvent);\r\n            return () => {\r\n                PubSub.unsubscribe(token);\r\n            }\r\n        }\r\n    }, []);\r\n\r\n    const pauseVoice = () => {\r\n        if (audio.current && range.current && !audio.current.paused) {\r\n            audio.current.pause();\r\n            setPlaying(false);\r\n        }\r\n    };\r\n\r\n    const playVoice = () => {\r\n        if (audio.current && range.current) {\r\n            if (!audio.current.paused) {\r\n                audio.current.pause();\r\n                setPlaying(false);\r\n            } else {\r\n\r\n                // Pause others\r\n                PubSub.publishSync(EVENT_TOPIC_CHAT_MESSAGE, 'pause');\r\n\r\n                console.log(data.mimeType);\r\n\r\n                if (isAudioMimeTypeSupported(data.mimeType)) {\r\n                    audio.current.play();\r\n                    setPlaying(true);\r\n                } else {\r\n                    const unsupportedFile = new UnsupportedFileClass({\r\n                        name: props.data.filename,\r\n                        link: props.data.audioLink\r\n                    });\r\n                    PubSub.publish(EVENT_TOPIC_UNSUPPORTED_FILE, unsupportedFile);\r\n                }\r\n            }\r\n\r\n            const interval = setInterval(function () {\r\n                if (audio.current && range.current) {\r\n                    const duration = audio.current.duration;\r\n                    const currentTime = audio.current.currentTime;\r\n\r\n                    setCurrentDuration(formatDuration(currentTime));\r\n\r\n                    if (duration) {\r\n                        const percentage = (currentTime * 100) / duration\r\n\r\n                        if (percentage >= 100) {\r\n                            setProgress(0);\r\n                            setCurrentDuration(formatDuration(0));\r\n                            setPlaying(false);\r\n                            clearInterval(interval);\r\n                        } else {\r\n                            setProgress(percentage);\r\n                        }\r\n                    }\r\n\r\n                    if (audio.current.paused) {\r\n                        clearInterval(interval);\r\n                    }\r\n                } else {\r\n                    // In case component is reloaded\r\n                    clearInterval(interval);\r\n                }\r\n            }, 300);\r\n        }\r\n    }\r\n\r\n    const formatDuration = (s) => {\r\n        s = Math.floor(s);\r\n        return (s-(s%=60))/60+(9<s?':':':0')+s;\r\n    }\r\n\r\n    const changeDuration = (value) => {\r\n        if (audio.current && range.current && audio.current.duration !== Infinity) {\r\n            setProgress(value);\r\n            const nextCurrentTime = audio.current.duration / value;\r\n            if (nextCurrentTime !== Infinity && !isNaN(nextCurrentTime)) {\r\n                audio.current.currentTime = parseFloat(nextCurrentTime);\r\n            }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"chat__voice\">\r\n            <span ref={duration} className=\"chat__voice__duration\">{currentDuration}</span>\r\n            <IconButton onClick={() => playVoice()}>\r\n                {isPlaying ? <PauseIcon style={playIconStyles}/> : <PlayArrowIcon style={playIconStyles}/>}\r\n            </IconButton>\r\n            <input ref={range} dir=\"ltr\" type=\"range\" className=\"chat__voice__range\" min=\"0\" max=\"100\" value={progress} onChange={(e) => changeDuration(e.target.value)} />\r\n            <audio ref={audio} src={data.voiceId ? data.generateVoiceLink() : data.generateAudioLink()} preload=\"none\" onLoadedMetadata={event => console.log(event.target.duration)} />\r\n\r\n            <Avatar className={(data.voiceId !== undefined ?? data.voiceLink !== undefined) ? avatarClasses[data.initials] : avatarClasses.orange + \" audioMessageAvatar\"}>\r\n                {data.voiceId !== undefined ? <span>{data.initials}</span> : <HeadsetIcon/>}\r\n            </Avatar>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ChatMessageVoice;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageTemplate.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageShortContent.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\ChatMessage\\ChatMessageTypeLabel.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\Helpers.js",["350","351","352","353"],"import {Emoji, getEmojiDataFromNative} from \"emoji-mart\";\r\nimport data from '../EmojiData.json'; //from 'emoji-mart/data/all.json'\r\nimport {BASE_URL, EMOJI_SET, EMOJI_SHEET_SIZE} from \"../Constants\";\r\nimport {getToken} from \"./StorageHelper\";\r\n\r\nconst { htmlToText } = require('html-to-text');\r\nconst emojiRegex = require('emoji-regex/RGI_Emoji.js');\r\n\r\nexport const getConfig = (params, cancelToken, responseType) => {\r\n    const config = {\r\n        withCredentials: false,\r\n        params,\r\n        headers: {\r\n            'Authorization': 'Token ' + getToken(),\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/json'\r\n        },\r\n        cancelToken: cancelToken\r\n    }\r\n\r\n    if (responseType !== undefined) {\r\n        config.responseType = responseType;\r\n    }\r\n\r\n    return config;\r\n}\r\n\r\nexport const getObjLength = (obj) => {\r\n    return obj ? Object.keys(obj).length : 0;\r\n}\r\n\r\nfunction linkify(inputText) {\r\n    let replacedText, replacePattern1, replacePattern2, replacePattern3;\r\n\r\n    // URLs starting with http://, https://, or ftp://\r\n    replacePattern1 = /(\\b(https?|ftp):\\/\\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/gim;\r\n    replacedText = inputText.replace(replacePattern1, '<a href=\"$1\" target=\"_blank\">$1</a>');\r\n\r\n    // URLs starting with \"www.\" (without // before it, or it'd re-link the ones done above).\r\n    replacePattern2 = /(^|[^/])(www\\.[\\S]+(\\b|$))/gim;\r\n    replacedText = replacedText.replace(replacePattern2, '$1<a href=\"http://$2\" target=\"_blank\">$2</a>');\r\n\r\n    // Change email addresses to mailto:: links.\r\n    replacePattern3 = /(([a-zA-Z0-9\\-_.])+@[a-zA-Z_]+?(\\.[a-zA-Z]{2,6})+)/gim;\r\n    replacedText = replacedText.replace(replacePattern3, '<a href=\"mailto:$1\">$1</a>');\r\n\r\n    return replacedText;\r\n}\r\n\r\nexport const formatMessage = (message) => {\r\n    if (!message) return;\r\n\r\n    let formatted = message.replaceAll('\\n', '<br/>');\r\n    formatted = linkify(formatted);\r\n    return replaceEmojis(formatted);\r\n}\r\n\r\nfunction containsOnlyEmojis(text) {\r\n    const onlyEmojis = text.replace(new RegExp('[\\u0000-\\u1eeff]', 'g'), '')\r\n    const visibleChars = text.replace(new RegExp('[\\n\\r\\s]+|( )+', 'g'), '')\r\n    return onlyEmojis.length === visibleChars.length\r\n}\r\n\r\nexport const replaceEmojis = (message, ignoreOnlyEmojis) => {\r\n    if (!message) return;\r\n\r\n    const onlyEmojis = !ignoreOnlyEmojis ? containsOnlyEmojis(message) : false;\r\n    const regex = emojiRegex();\r\n\r\n    return message.replace(regex, function (occurrence) {\r\n        // TODO: Finding emoji data is too slow, find an alternative or improve it\r\n        const emojiData = getEmojiDataFromNative(occurrence, EMOJI_SET, data);\r\n        if (emojiData) {\r\n            const emoji = Emoji({\r\n                html: true,\r\n                emoji: emojiData,\r\n                size: onlyEmojis ? 44 : 22,\r\n                set: EMOJI_SET,\r\n                sheetSize: EMOJI_SHEET_SIZE\r\n            });\r\n\r\n            // Emoji might be null\r\n            return emoji ?? occurrence;\r\n\r\n        } else {\r\n            return occurrence;\r\n        }\r\n    });\r\n}\r\n\r\nexport const translateHTMLInputToText = (html) => {\r\n    let result;\r\n    //const reg = new RegExp('((<span\\\\b[^>]*\\\\s\\\\bstyle=([\"\\'])([^\"]*)\\\\3[^>]*>)(.*?)</span>)', 'g');\r\n    const reg = new RegExp('<img\\\\s[^>]*?src\\\\s*=\\\\s*[\\'\\\\\"]([^\\'\\\\\"]*?)[\\'\\\\\"][^>]*?>', 'g');\r\n    result = html.replace(reg, function (occurrences) {\r\n        // Extract unicode from aria-label\r\n        const matches = occurrences.match(new RegExp('aria-label=\"\\\\s*(.*?)\\\\s*,'), '$1');\r\n        if (matches && matches.length >= 1) {\r\n            return matches[1];\r\n        }\r\n        return '';\r\n    });\r\n\r\n    // Convert it to plain text\r\n    result = htmlToText(result);\r\n\r\n    return result;\r\n}\r\n\r\nexport const markOccurrences = (message, sub) => {\r\n    if (!message) return;\r\n\r\n    const reg = new RegExp('(' + sub + ')', 'gi');\r\n    return message.replace(reg, '<span class=\"searchOccurrence\">$1</span>');\r\n}\r\n\r\nexport const generateInitialsHelper = (name) => {\r\n    return (name ? name.replace(/[^a-z\\d\\s]+/gi, '').trim()[0] : '')?.toUpperCase();\r\n}\r\n\r\nexport const getFirstObject = (jsonObject) => {\r\n    return jsonObject[Object.keys(jsonObject)[0]];\r\n}\r\n\r\nexport const getLastObject = (jsonObject) => {\r\n    return jsonObject[Object.keys(jsonObject)[Object.keys(jsonObject).length - 1]];\r\n}\r\n\r\nexport const getObjectByIndex = (jsonObject, index) => {\r\n    return jsonObject[Object.keys(jsonObject)[index]];\r\n}\r\n\r\nexport const getLastKey = (jsonObject) => {\r\n    const keys = Object.keys(jsonObject);\r\n    return keys[keys.length - 1];\r\n}\r\n\r\nexport const getLastMessageAndExtractTimestamp = (messagesObject) => {\r\n    const last = getLastObject(messagesObject);\r\n    return extractTimestampFromMessage(last);\r\n}\r\n\r\nexport const extractTimestampFromMessage = (message) => {\r\n    return message ? parseInt(message.timestamp) : -1;\r\n}\r\n\r\nexport const generateUnixTimestamp = () => {\r\n    return Math.round(+new Date() / 1000);\r\n}\r\n\r\nexport const stringContainsAnyInArray = (string, array) => {\r\n    for (let i = 0; i < array.length; i++) {\r\n        if (string.includes(array[i])) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexport const getSelectionHtml = () => {\r\n    let html = \"\";\r\n    if (typeof window.getSelection != \"undefined\") {\r\n        const sel = window.getSelection();\r\n        if (sel.rangeCount) {\r\n            const container = document.createElement(\"div\");\r\n            for (let i = 0, len = sel.rangeCount; i < len; ++i) {\r\n                container.appendChild(sel.getRangeAt(i).cloneContents());\r\n            }\r\n            html = container.innerHTML;\r\n        }\r\n    } else if (typeof document.selection != \"undefined\") {\r\n        if (document.selection.type === \"Text\") {\r\n            html = document.selection.createRange().htmlText;\r\n        }\r\n    }\r\n    return html;\r\n}\r\n\r\nexport const getAdminPanelURL = () => {\r\n    return BASE_URL.replace('/api/v1', '/admin');\r\n}\r\n\r\nexport const getHubURL = () => {\r\n    return BASE_URL.replace('/api/v1', '/hub');\r\n}\r\n\r\nexport const getBaseURL = () => {\r\n    const windowLocation = window.location;\r\n    return windowLocation.protocol + \"//\" + windowLocation.host + \"/\";\r\n}\r\n\r\nexport const getWebSocketURL = () => {\r\n    const baseURL = getBaseURL();\r\n    if (baseURL.includes('localhost') || baseURL.includes('10.0.2.2')) {\r\n        return 'wss://websockets.whatsapp.kondz.io/';\r\n    } else {\r\n        return baseURL.replace('https://', 'wss://websockets.').replace('http://', 'wss://websockets.');\r\n    }\r\n}\r\n\r\nexport const displaySeconds = (seconds) => {\r\n    const format = val => `0${Math.floor(val)}`.slice(-2);\r\n    //const hours = seconds / 3600;\r\n    const minutes = (seconds % 3600) / 60;\r\n\r\n    return [minutes, seconds % 60].map(format).join(':');\r\n}\r\n\r\nexport const getTemplateParams = (text) => {\r\n    const matches = text?.match(/\\{{(.*?)\\}}/g);\r\n    return matches ? matches : [];\r\n}\r\n\r\nexport const templateParamToInteger = (templateParam) => {\r\n    return templateParam.match(/\\d+/);\r\n}\r\n\r\nexport const insertTemplateComponentParameters = (component, params) => {\r\n    if (!component) return;\r\n\r\n    const type = component.type.toLowerCase();\r\n    const format = component.format ? component.format.toLowerCase() : \"text\";\r\n    let text = component[format];\r\n\r\n    if (!params) return text;\r\n\r\n    for (let i = 0; i < params.length; i++) {\r\n        const component = params[i];\r\n\r\n        if (component.type === type) {\r\n            component.parameters.forEach((param, index) => {\r\n                const paramType = param.type;\r\n\r\n                const paramValue = param[paramType].fallback_value ?? param[paramType];\r\n                text = text.replace(`{{${index+1}}}`, paramValue);\r\n            });\r\n\r\n            break;\r\n        }\r\n    }\r\n\r\n    return text;\r\n}\r\n\r\nconst removeWhitespaces = (text) => {\r\n    return text.replace(/ /g,'');\r\n}\r\n\r\nconst removeHyphens = (text) => {\r\n    return text.replace(/-/g, '');\r\n}\r\n\r\nconst removePluses = (text) => {\r\n    return text.replace(/\\+/g,'');\r\n}\r\n\r\nexport const preparePhoneNumber = (phoneNumber) => {\r\n    phoneNumber = removeHyphens(phoneNumber);\r\n    phoneNumber = removeWhitespaces(phoneNumber);\r\n    phoneNumber = removePluses(phoneNumber);\r\n\r\n    return phoneNumber;\r\n}\r\n\r\nexport const addPlus = (phoneNumber) => {\r\n    return phoneNumber?.includes('+') ? phoneNumber : `+${phoneNumber}`;\r\n}\r\n\r\nexport const containsLetters = (text) => {\r\n    const regExp = /[a-zA-Z]/g;\r\n    return regExp.test(text);\r\n}\r\n\r\nexport const extractAvatarFromContactProviderData = (contactProviderData) => {\r\n    if (contactProviderData) {\r\n        for (let i = 0; i < getObjLength(contactProviderData); i++) {\r\n            const data = contactProviderData[i];\r\n            if (data?.avatar) {\r\n                return data.avatar;\r\n            }\r\n        }\r\n    }\r\n\r\n    return undefined;\r\n}\r\n\r\nexport const hasInternetConnection = () => {\r\n    return navigator.onLine;\r\n}\r\n\r\nexport const sortMessagesAsc = (messages) => {\r\n    let sortedNextState = Object.entries(messages).sort((a, b) => a[1].timestamp - b[1].timestamp);\r\n    return Object.fromEntries(sortedNextState);\r\n}\r\n\r\nexport const isScrollable = (el) => {\r\n    const hasScrollableContent = el.scrollHeight > el.clientHeight;\r\n    const overflowYStyle = window.getComputedStyle(el).overflowY;\r\n    const isOverflowHidden = overflowYStyle.indexOf('hidden') !== -1;\r\n\r\n    return hasScrollableContent && !isOverflowHidden;\r\n}","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\StorageHelper.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\SidebarHelper.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\FileHelper.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\DateHelper.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\Helpers\\ChatHelper.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\BulkSendIndicator.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\UserClass.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\SelectableChatTag.js",["354"],"import React, {useEffect, useState} from \"react\";\r\nimport {Checkbox, ListItem} from \"@material-ui/core\";\r\nimport LabelIcon from \"@material-ui/icons/Label\";\r\nimport '../../styles/SelectableChatTag.css';\r\n\r\nfunction SelectableChatTag(props) {\r\n    const [isSelected, setSelected] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setSelected(props.selectedTags.includes(props.data.id));\r\n    }, [props.selectedTags]);\r\n\r\n    const handleClick = () => {\r\n        props.setSelectedTags(prevState => {\r\n            if (prevState.includes(props.data.id)) {\r\n                prevState = prevState.filter(arrayItem => arrayItem !== props.data.id);\r\n            } else {\r\n                prevState.push(props.data.id);\r\n            }\r\n\r\n            return [...prevState];\r\n        });\r\n    }\r\n\r\n    return (\r\n        <ListItem className=\"sidebarTagListItem\" button onClick={handleClick}>\r\n            <div className={\r\n                'sidebarTag '\r\n                + (isSelected ? 'isSelected ' : '')\r\n            }>\r\n                <Checkbox className=\"sidebarTag__selection\" checked={isSelected} color=\"primary\"/>\r\n                <div className=\"sidebarTag__selection__tag\">\r\n                    <LabelIcon style={{fill: props.data.web_inbox_color}} />\r\n                    {props.data.name}\r\n                </div>\r\n            </div>\r\n        </ListItem>\r\n    )\r\n}\r\n\r\nexport default SelectableChatTag;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Sidebar\\BulkSendActions.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\Main.js",["355"],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\ContactDetails.js",["356"],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\ChatAssignment.js",["357"],"import React, {useEffect, useState} from \"react\";\r\nimport {\r\n    Button,\r\n    CircularProgress,\r\n    Dialog,\r\n    DialogActions,\r\n    DialogContent,\r\n    DialogContentText,\r\n    DialogTitle,\r\n    FormControl,\r\n    InputLabel,\r\n    MenuItem,\r\n    Select\r\n} from \"@material-ui/core\";\r\nimport axios from \"axios\";\r\nimport {BASE_URL} from \"../../Constants\";\r\nimport {getConfig} from \"../../Helpers/Helpers\";\r\nimport '../../styles/ChatAssignment.css';\r\n\r\nfunction ChatAssignment(props) {\r\n\r\n    const [isLoading, setLoading] = useState(true);\r\n    const [users, setUsers] = useState([]);\r\n    const [groups, setGroups] = useState([]);\r\n    const [assignedToUser, setAssignedToUser] = useState('null');\r\n    const [assignedGroup, setAssignedGroup] = useState('null');\r\n\r\n    useEffect(() => {\r\n        listUsers();\r\n    }, []);\r\n\r\n    const close = () => {\r\n        props.setOpen(false);\r\n    }\r\n\r\n    const retrieveChatAssignment = () => {\r\n        axios.get( `${BASE_URL}chat_assignment/${props.waId}/`, getConfig())\r\n            .then((response) => {\r\n                console.log(\"Assignment: \", response.data);\r\n\r\n                setAssignedToUser(response.data.assigned_to_user ?? 'null');\r\n                setAssignedGroup(response.data.assigned_group ?? 'null');\r\n\r\n                setLoading(false);\r\n            })\r\n            .catch((error) => {\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const updateChatAssignment = () => {\r\n        axios.put( `${BASE_URL}chat_assignment/${props.waId}/`, {\r\n            'wa_id': props.waId,\r\n            'assigned_to_user': assignedToUser === 'null' ? null : assignedToUser,\r\n            'assigned_group': assignedGroup === 'null' ? null : assignedGroup,\r\n        }, getConfig())\r\n            .then((response) => {\r\n                console.log(\"Assignment: \", response.data);\r\n\r\n                close();\r\n            })\r\n            .catch((error) => {\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const listUsers = () => {\r\n        axios.get( `${BASE_URL}users/`, getConfig())\r\n            .then((response) => {\r\n                console.log(\"Users: \", response.data);\r\n\r\n                setUsers(response.data.results);\r\n\r\n                // Next\r\n                listGroups();\r\n            })\r\n            .catch((error) => {\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const listGroups = () => {\r\n        axios.get( `${BASE_URL}groups/`, getConfig())\r\n            .then((response) => {\r\n                console.log(\"Groups: \", response.data);\r\n\r\n                setGroups(response.data.results);\r\n\r\n                // Next\r\n                retrieveChatAssignment();\r\n            })\r\n            .catch((error) => {\r\n                window.displayError(error);\r\n            });\r\n    }\r\n\r\n    const handleUserChange = (event) => {\r\n        setAssignedToUser(event.target.value);\r\n    }\r\n\r\n    const handleGroupChange = (event) => {\r\n        setAssignedGroup(event.target.value);\r\n    }\r\n\r\n    const prepareUserLabel = (user) => {\r\n        let label = '';\r\n        if (user.first_name) {\r\n            label = user.first_name;\r\n        }\r\n\r\n        if (user.last_name) {\r\n            if (label) {\r\n                label += ' ';\r\n            }\r\n\r\n            label += user.last_name;\r\n        }\r\n\r\n        if (label) {\r\n            label += ` (${user.username})`;\r\n        } else {\r\n            label = user.username;\r\n        }\r\n\r\n        return label;\r\n    }\r\n\r\n    return (\r\n        <Dialog open={props.open} onClose={close} className=\"chatAssignmentWrapper\">\r\n            <DialogTitle>Assign chat</DialogTitle>\r\n            <DialogContent className=\"chatAssignment\">\r\n\r\n                <DialogContentText>You can assign this chat to a user or a group.</DialogContentText>\r\n\r\n                <FormControl fullWidth={true}>\r\n                    <InputLabel id=\"assign-user-select-label\">User</InputLabel>\r\n                    <Select\r\n                        labelId=\"assign-user-select-label\"\r\n                        id=\"assign-user-select\"\r\n                        value={assignedToUser}\r\n                        onChange={handleUserChange}>\r\n                        <MenuItem value=\"null\">Unassigned</MenuItem>\r\n                        {users?.map((user) =>\r\n                            <MenuItem key={user.id} value={user.id}>{prepareUserLabel(user)}</MenuItem>\r\n                        )}\r\n                    </Select>\r\n                </FormControl>\r\n\r\n                <FormControl fullWidth={true}>\r\n                    <InputLabel id=\"assign-group-select-label\">Group</InputLabel>\r\n                    <Select\r\n                        labelId=\"assign-group-select-label\"\r\n                        id=\"assign-group-select\"\r\n                        value={assignedGroup}\r\n                        onChange={handleGroupChange}>\r\n                        <MenuItem value=\"null\">Unassigned</MenuItem>\r\n                        {groups?.map((group) =>\r\n                            <MenuItem key={group.id} value={group.id}>{group.name}</MenuItem>\r\n                        )}\r\n                    </Select>\r\n                </FormControl>\r\n\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={close} color=\"secondary\">Close</Button>\r\n                <Button color=\"primary\" onClick={updateChatAssignment}>Update</Button>\r\n            </DialogActions>\r\n\r\n            {isLoading &&\r\n            <div className=\"chatAssignmentWrapper__loading\">\r\n                <CircularProgress size={28} />\r\n            </div>\r\n            }\r\n\r\n        </Dialog>\r\n    )\r\n}\r\n\r\nexport default ChatAssignment;","C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\LoadingScreen.js",["358"],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\ChatTags.js",["359","360","361"],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\PreviewMedia.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Main\\ChatTagsList.js",["362","363","364","365","366"],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\TemplateMessages.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\SavedResponses.js",[],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\PreviewSendMedia.js",["367","368","369","370"],"C:\\Users\\Berkay\\PhpstormProjects\\wpclone\\src\\components\\Chat\\SendTemplateMessage.js",["371","372","373"],{"ruleId":"374","replacedBy":"375"},{"ruleId":"376","replacedBy":"377"},{"ruleId":"378","severity":1,"message":"379","line":66,"column":8,"nodeType":"380","endLine":66,"endColumn":10,"suggestions":"381"},{"ruleId":"382","severity":1,"message":"383","line":19,"column":7,"nodeType":"384","messageId":"385","endLine":19,"endColumn":26},{"ruleId":"382","severity":1,"message":"386","line":9,"column":12,"nodeType":"384","messageId":"385","endLine":9,"endColumn":18},{"ruleId":"382","severity":1,"message":"387","line":11,"column":11,"nodeType":"384","messageId":"385","endLine":11,"endColumn":27},{"ruleId":"388","severity":1,"message":"389","line":57,"column":60,"nodeType":"390","messageId":"391","endLine":57,"endColumn":62},{"ruleId":"382","severity":1,"message":"392","line":1,"column":16,"nodeType":"384","messageId":"385","endLine":1,"endColumn":24},{"ruleId":"382","severity":1,"message":"393","line":25,"column":11,"nodeType":"384","messageId":"385","endLine":25,"endColumn":26},{"ruleId":"378","severity":1,"message":"394","line":45,"column":8,"nodeType":"380","endLine":45,"endColumn":10,"suggestions":"395"},{"ruleId":"378","severity":1,"message":"396","line":49,"column":8,"nodeType":"380","endLine":49,"endColumn":14,"suggestions":"397"},{"ruleId":"382","severity":1,"message":"398","line":5,"column":76,"nodeType":"384","messageId":"385","endLine":5,"endColumn":93},{"ruleId":"378","severity":1,"message":"399","line":52,"column":8,"nodeType":"380","endLine":52,"endColumn":10,"suggestions":"400"},{"ruleId":"378","severity":1,"message":"401","line":74,"column":8,"nodeType":"380","endLine":74,"endColumn":17,"suggestions":"402"},{"ruleId":"403","severity":1,"message":"404","line":11,"column":13,"nodeType":"405","endLine":11,"endColumn":39},{"ruleId":"403","severity":1,"message":"404","line":14,"column":13,"nodeType":"405","endLine":14,"endColumn":37},{"ruleId":"403","severity":1,"message":"404","line":17,"column":13,"nodeType":"405","endLine":17,"endColumn":38},{"ruleId":"378","severity":1,"message":"406","line":117,"column":8,"nodeType":"380","endLine":117,"endColumn":10,"suggestions":"407"},{"ruleId":"378","severity":1,"message":"408","line":153,"column":8,"nodeType":"380","endLine":153,"endColumn":14,"suggestions":"409"},{"ruleId":"378","severity":1,"message":"410","line":157,"column":8,"nodeType":"380","endLine":157,"endColumn":16,"suggestions":"411"},{"ruleId":"378","severity":1,"message":"412","line":168,"column":8,"nodeType":"380","endLine":168,"endColumn":33,"suggestions":"413"},{"ruleId":"378","severity":1,"message":"414","line":238,"column":8,"nodeType":"380","endLine":238,"endColumn":83,"suggestions":"415"},{"ruleId":"378","severity":1,"message":"416","line":413,"column":8,"nodeType":"380","endLine":413,"endColumn":104,"suggestions":"417"},{"ruleId":"378","severity":1,"message":"418","line":551,"column":8,"nodeType":"380","endLine":551,"endColumn":30,"suggestions":"419"},{"ruleId":"378","severity":1,"message":"420","line":557,"column":8,"nodeType":"380","endLine":557,"endColumn":23,"suggestions":"421"},{"ruleId":"382","severity":1,"message":"422","line":48,"column":28,"nodeType":"384","messageId":"385","endLine":48,"endColumn":45},{"ruleId":"382","severity":1,"message":"423","line":54,"column":40,"nodeType":"384","messageId":"385","endLine":54,"endColumn":67},{"ruleId":"378","severity":1,"message":"424","line":95,"column":8,"nodeType":"380","endLine":95,"endColumn":17,"suggestions":"425"},{"ruleId":"378","severity":1,"message":"426","line":193,"column":8,"nodeType":"380","endLine":193,"endColumn":55,"suggestions":"427"},{"ruleId":"378","severity":1,"message":"428","line":229,"column":8,"nodeType":"380","endLine":229,"endColumn":30,"suggestions":"429"},{"ruleId":"378","severity":1,"message":"410","line":35,"column":8,"nodeType":"380","endLine":35,"endColumn":10,"suggestions":"430"},{"ruleId":"378","severity":1,"message":"431","line":99,"column":8,"nodeType":"380","endLine":99,"endColumn":82,"suggestions":"432"},{"ruleId":"378","severity":1,"message":"433","line":47,"column":8,"nodeType":"380","endLine":47,"endColumn":10,"suggestions":"434"},{"ruleId":"435","severity":1,"message":"436","line":6,"column":9,"nodeType":"405","endLine":6,"endColumn":130},{"ruleId":"378","severity":1,"message":"437","line":43,"column":8,"nodeType":"380","endLine":43,"endColumn":10,"suggestions":"438"},{"ruleId":"439","severity":1,"message":"440","line":59,"column":48,"nodeType":"441","messageId":"442","endLine":59,"endColumn":66},{"ruleId":"439","severity":1,"message":"443","line":60,"column":50,"nodeType":"441","messageId":"442","endLine":60,"endColumn":66},{"ruleId":"444","severity":1,"message":"445","line":60,"column":56,"nodeType":"441","messageId":"446","endLine":60,"endColumn":57,"suggestions":"447"},{"ruleId":"448","severity":1,"message":"449","line":232,"column":42,"nodeType":"390","messageId":"450","endLine":237,"endColumn":14},{"ruleId":"378","severity":1,"message":"451","line":11,"column":8,"nodeType":"380","endLine":11,"endColumn":28,"suggestions":"452"},{"ruleId":"378","severity":1,"message":"453","line":480,"column":8,"nodeType":"380","endLine":480,"endColumn":10,"suggestions":"454"},{"ruleId":"378","severity":1,"message":"455","line":29,"column":8,"nodeType":"380","endLine":29,"endColumn":10,"suggestions":"456"},{"ruleId":"378","severity":1,"message":"457","line":30,"column":8,"nodeType":"380","endLine":30,"endColumn":10,"suggestions":"458"},{"ruleId":"403","severity":1,"message":"404","line":28,"column":17,"nodeType":"405","endLine":28,"endColumn":40},{"ruleId":"382","severity":1,"message":"459","line":21,"column":12,"nodeType":"384","messageId":"385","endLine":21,"endColumn":16},{"ruleId":"378","severity":1,"message":"460","line":28,"column":8,"nodeType":"380","endLine":28,"endColumn":10,"suggestions":"461"},{"ruleId":"388","severity":1,"message":"462","line":31,"column":48,"nodeType":"390","messageId":"463","endLine":31,"endColumn":50},{"ruleId":"382","severity":1,"message":"464","line":1,"column":16,"nodeType":"384","messageId":"385","endLine":1,"endColumn":25},{"ruleId":"382","severity":1,"message":"465","line":2,"column":8,"nodeType":"384","messageId":"385","endLine":2,"endColumn":13},{"ruleId":"382","severity":1,"message":"466","line":3,"column":9,"nodeType":"384","messageId":"385","endLine":3,"endColumn":17},{"ruleId":"382","severity":1,"message":"467","line":4,"column":9,"nodeType":"384","messageId":"385","endLine":4,"endColumn":18},{"ruleId":"382","severity":1,"message":"468","line":20,"column":23,"nodeType":"384","messageId":"385","endLine":20,"endColumn":33},{"ruleId":"378","severity":1,"message":"469","line":132,"column":8,"nodeType":"380","endLine":132,"endColumn":10,"suggestions":"470"},{"ruleId":"378","severity":1,"message":"471","line":157,"column":8,"nodeType":"380","endLine":157,"endColumn":26,"suggestions":"472"},{"ruleId":"378","severity":1,"message":"473","line":168,"column":8,"nodeType":"380","endLine":168,"endColumn":24,"suggestions":"474"},{"ruleId":"378","severity":1,"message":"475","line":176,"column":8,"nodeType":"380","endLine":176,"endColumn":14,"suggestions":"476"},{"ruleId":"388","severity":1,"message":"389","line":43,"column":75,"nodeType":"390","messageId":"391","endLine":43,"endColumn":77},{"ruleId":"378","severity":1,"message":"477","line":56,"column":8,"nodeType":"380","endLine":56,"endColumn":10,"suggestions":"478"},{"ruleId":"435","severity":1,"message":"436","line":172,"column":45,"nodeType":"405","endLine":172,"endColumn":85},"no-native-reassign",["479"],"no-negated-in-lhs",["480"],"react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'errorCase', 'errorMessages', and 'history'. Either include them or remove the dependency array.","ArrayExpression",["481"],"no-unused-vars","'prepareStylesObject' is assigned a value but never used.","Identifier","unusedVar","'hidden' is assigned a value but never used.","'handleVisibility' is assigned a value but never used.","array-callback-return","Array.prototype.map() expects a return value from arrow function.","ArrowFunctionExpression","expectedInside","'useState' is defined but never used.","'handleClickOpen' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'cancelVoiceRecord' and 'requestMicrophonePermission'. Either include them or remove the dependency array.",["482"],"React Hook useEffect has a missing dependency: 'cancelVoiceRecord'. Either include it or remove the dependency array.",["483"],"'removeWhitespaces' is defined but never used.","React Hook useEffect has missing dependencies: 'findContacts' and 'props'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["484"],"React Hook useEffect has missing dependencies: 'findContacts' and 'findPersons'. Either include them or remove the dependency array.",["485"],"jsx-a11y/alt-text","img elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","JSXOpeningElement","React Hook useEffect has missing dependencies: 'props' and 'waId'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["486"],"React Hook useEffect has missing dependencies: 'getPerson' and 'props'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["487"],"React Hook useEffect has a missing dependency: 'props'. Either include it or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["488"],"React Hook useEffect has missing dependencies: 'currentNewMessages' and 'getNewMessagesCount'. Either include them or remove the dependency array.",["489"],"React Hook useEffect has missing dependencies: 'getMessages' and 'markAsReceived'. Either include them or remove the dependency array.",["490"],"React Hook useEffect has a missing dependency: 'markAsReceived'. Either include it or remove the dependency array.",["491"],"React Hook useEffect has a missing dependency: 'goToMessageId'. Either include it or remove the dependency array.",["492"],"React Hook useEffect has a missing dependency: 'handleChosenFiles'. Either include it or remove the dependency array.",["493"],"'setContactResults' is assigned a value but never used.","'setBulkSendIndicatorVisible' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'getChats' and 'searchMessages'. Either include them or remove the dependency array.",["494"],"React Hook useEffect has missing dependencies: 'props' and 'retrieveChat'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["495"],"React Hook useEffect has a missing dependency: 'getChats'. Either include it or remove the dependency array.",["496"],["497"],"React Hook useEffect has a missing dependency: 'props.chatData.lastReceivedMessageTimestamp'. Either include it or remove the dependency array.",["498"],"React Hook useEffect has missing dependencies: 'getBusinessProfile' and 'props'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["499"],"react/jsx-no-target-blank","Using target=\"_blank\" without rel=\"noreferrer\" is a security risk: see https://html.spec.whatwg.org/multipage/links.html#link-type-noopener","React Hook useEffect has missing dependencies: 'data' and 'onChatMessageEvent'. Either include them or remove the dependency array.",["500"],"no-control-regex","Unexpected control character(s) in regular expression: \\x00.","Literal","unexpected","Unexpected control character(s) in regular expression: \\x0a, \\x0d.","no-useless-escape","Unnecessary escape character: \\s.","unnecessaryEscape",["501","502"],"no-loop-func","Function declared in a loop contains unsafe references to variable(s) 'text', 'text'.","unsafeRefs","React Hook useEffect has a missing dependency: 'props.data.id'. Either include it or remove the dependency array. If 'setSelected' needs the current value of 'props.data.id', you can also switch to useReducer instead of useState and read 'props.data.id' in the reducer.",["503"],"React Hook useEffect has missing dependencies: 'clearUserSession', 'goToChatByWaId', 'location', 'onDisplayError', and 'retrieveCurrentUser'. Either include them or remove the dependency array.",["504"],"React Hook useEffect has missing dependencies: 'getChatByWaId' and 'props'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["505"],"React Hook useEffect has a missing dependency: 'listUsers'. Either include it or remove the dependency array.",["506"],"'chat' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'retrieveChat'. Either include it or remove the dependency array.",["507"],"Array.prototype.filter() expects a value to be returned at the end of arrow function.","expectedAtEnd","'useEffect' is defined but never used.","'axios' is defined but never used.","'BASE_URL' is defined but never used.","'getConfig' is defined but never used.","'setLoading' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'forceUpdate' and 'props'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["508"],"React Hook useEffect has missing dependencies: 'changePreview' and 'hidePreview'. Either include them or remove the dependency array.",["509"],"React Hook useEffect has a missing dependency: 'chosenFile'. Either include it or remove the dependency array.",["510"],"React Hook useEffect has missing dependencies: 'changePreview' and 'chosenFile'. Either include them or remove the dependency array.",["511"],"React Hook useEffect has a missing dependency: 'template.components'. Either include it or remove the dependency array.",["512"],"no-global-assign","no-unsafe-negation",{"desc":"513","fix":"514"},{"desc":"515","fix":"516"},{"desc":"517","fix":"518"},{"desc":"519","fix":"520"},{"desc":"521","fix":"522"},{"desc":"523","fix":"524"},{"desc":"525","fix":"526"},{"desc":"527","fix":"528"},{"desc":"529","fix":"530"},{"desc":"531","fix":"532"},{"desc":"533","fix":"534"},{"desc":"535","fix":"536"},{"desc":"537","fix":"538"},{"desc":"539","fix":"540"},{"desc":"541","fix":"542"},{"desc":"543","fix":"544"},{"desc":"545","fix":"546"},{"desc":"547","fix":"548"},{"desc":"549","fix":"550"},{"desc":"551","fix":"552"},{"messageId":"553","fix":"554","desc":"555"},{"messageId":"556","fix":"557","desc":"558"},{"desc":"559","fix":"560"},{"desc":"561","fix":"562"},{"desc":"563","fix":"564"},{"desc":"565","fix":"566"},{"desc":"567","fix":"568"},{"desc":"569","fix":"570"},{"desc":"571","fix":"572"},{"desc":"573","fix":"574"},{"desc":"575","fix":"576"},{"desc":"577","fix":"578"},"Update the dependencies array to be: [errorCase, errorMessages, history]",{"range":"579","text":"580"},"Update the dependencies array to be: [cancelVoiceRecord, requestMicrophonePermission]",{"range":"581","text":"582"},"Update the dependencies array to be: [cancelVoiceRecord, waId]",{"range":"583","text":"584"},"Update the dependencies array to be: [findContacts, props]",{"range":"585","text":"586"},"Update the dependencies array to be: [findContacts, findPersons, keyword]",{"range":"587","text":"588"},"Update the dependencies array to be: [props, waId]",{"range":"589","text":"590"},"Update the dependencies array to be: [getPerson, props, waId]",{"range":"591","text":"592"},"Update the dependencies array to be: [person, props]",{"range":"593","text":"594"},"Update the dependencies array to be: [waId, props.newMessages, getNewMessagesCount, currentNewMessages]",{"range":"595","text":"596"},"Update the dependencies array to be: [messages, isLoaded, isLoadingMoreMessages, isAtBottom, currentNewMessages, markAsReceived, getMessages]",{"range":"597","text":"598"},"Update the dependencies array to be: [waId, messages, isLoaded, isExpired, isAtBottom, currentNewMessages, markAsReceived]",{"range":"599","text":"600"},"Update the dependencies array to be: [messages, isAtBottom, goToMessageId]",{"range":"601","text":"602"},"Update the dependencies array to be: [handleChosenFiles, selectedFiles]",{"range":"603","text":"604"},"Update the dependencies array to be: [getChats, keyword, searchMessages]",{"range":"605","text":"606"},"Update the dependencies array to be: [waId, props.chats, props.newMessages, keyword, props, retrieveChat]",{"range":"607","text":"608"},"Update the dependencies array to be: [props.chats, keyword, getChats]",{"range":"609","text":"610"},"Update the dependencies array to be: [props]",{"range":"611","text":"612"},"Update the dependencies array to be: [isExpired, props.chatData.isExpired, props.chatData.lastMessageTimestamp, props.chatData.lastReceivedMessageTimestamp]",{"range":"613","text":"614"},"Update the dependencies array to be: [getBusinessProfile, props]",{"range":"615","text":"616"},"Update the dependencies array to be: [data, onChatMessageEvent]",{"range":"617","text":"618"},"removeEscape",{"range":"619","text":"620"},"Remove the `\\`. This maintains the current functionality.","escapeBackslash",{"range":"621","text":"622"},"Replace the `\\` with `\\\\` to include the actual backslash character.","Update the dependencies array to be: [props.data.id, props.selectedTags]",{"range":"623","text":"624"},"Update the dependencies array to be: [clearUserSession, goToChatByWaId, location, onDisplayError, retrieveCurrentUser]",{"range":"625","text":"626"},"Update the dependencies array to be: [getChatByWaId, props]",{"range":"627","text":"628"},"Update the dependencies array to be: [listUsers]",{"range":"629","text":"630"},"Update the dependencies array to be: [retrieveChat]",{"range":"631","text":"632"},"Update the dependencies array to be: [forceUpdate, props]",{"range":"633","text":"634"},"Update the dependencies array to be: [changePreview, chosenFile, data, hidePreview]",{"range":"635","text":"636"},"Update the dependencies array to be: [chosenFile, currentCaption]",{"range":"637","text":"638"},"Update the dependencies array to be: [changePreview, chosenFile, data]",{"range":"639","text":"640"},"Update the dependencies array to be: [template.components]",{"range":"641","text":"642"},[2198,2200],"[errorCase, errorMessages, history]",[1451,1453],"[cancelVoiceRecord, requestMicrophonePermission]",[1519,1525],"[cancelVoiceRecord, waId]",[1995,1997],"[findContacts, props]",[2551,2560],"[findContacts, findPersons, keyword]",[4428,4430],"[props, waId]",[5407,5413],"[getPerson, props, waId]",[5490,5498],"[person, props]",[5819,5844],"[waId, props.newMessages, getNewMessagesCount, currentNewMessages]",[8824,8899],"[messages, isLoaded, isLoadingMoreMessages, isAtBottom, currentNewMessages, markAsReceived, getMessages]",[16250,16346],"[waId, messages, isLoaded, isExpired, isAtBottom, currentNewMessages, markAsReceived]",[21346,21368],"[messages, isAtBottom, goToMessageId]",[21479,21494],"[handleChosenFiles, selectedFiles]",[3355,3364],"[getChats, keyword, searchMessages]",[7673,7720],"[waId, props.chats, props.newMessages, keyword, props, retrieveChat]",[8820,8842],"[props.chats, keyword, getChats]",[1341,1343],"[props]",[3268,3342],"[isExpired, props.chatData.isExpired, props.chatData.lastMessageTimestamp, props.chatData.lastReceivedMessageTimestamp]",[1649,1651],"[getBusinessProfile, props]",[1494,1496],"[data, onChatMessageEvent]",[2170,2171],"",[2170,2170],"\\",[396,416],"[props.data.id, props.selectedTags]",[17660,17662],"[clearUserSession, goToChatByWaId, location, onDisplayError, retrieveCurrentUser]",[1126,1128],"[getChatByWaId, props]",[816,818],"[listUsers]",[749,751],"[retrieveChat]",[4505,4507],"[forceUpdate, props]",[5383,5401],"[changePreview, chosenFile, data, hidePreview]",[5684,5700],"[chosenFile, currentCaption]",[5863,5869],"[changePreview, chosenFile, data]",[2055,2057],"[template.components]"]